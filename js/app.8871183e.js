(function(e){function t(t){for(var o,i,c=t[0],s=t[1],u=t[2],h=0,f=[];h<c.length;h++)i=c[h],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},a={app:0},r=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/DemoPresent/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"037f":function(e,t,n){"use strict";n("4ec8")},"03d9":function(e,t,n){e.exports=n.p+"af0aa292b08c0de963ff646b6f02aa3c.glb"},"0722":function(e,t,n){"use strict";n("6b2b")},"0bb0":function(e,t,n){"use strict";n("8daf")},1735:function(e,t,n){},"39c6":function(e,t,n){"use strict";n("9c5f")},"4b27":function(e,t,n){},"4ec8":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23");function a(e,t,n,a,r,i){var c=Object(o["s"])("RenderVue"),s=Object(o["s"])("Scene3D"),u=Object(o["s"])("Rete");return Object(o["m"])(),Object(o["f"])(o["a"],null,[Object(o["i"])(c),Object(o["i"])(s,{style:{width:"200px",height:"200px",position:"fixed",padding:"10px"},ref:"previewAll",modelStore:this.modelStore},null,8,["modelStore"]),Object(o["i"])(u,{style:{width:"100%",height:"100%"},modelStore:this.modelStore},null,8,["modelStore"])],64)}var r=n("1da1"),i=(n("96cf"),function(e){return Object(o["o"])("data-v-2ed7a4be"),e=e(),Object(o["n"])(),e}),c={id:"rete",ref:"rete",class:"node-editor"},s={class:"float-panel"},u={class:"text",style:{color:"white","padding-bottom":"100px","margin-left":"0px"}},l=i((function(){return Object(o["g"])("span",{class:"text"},[Object(o["g"])("br"),Object(o["h"])(".")],-1)})),h={class:"switch"},f=i((function(){return Object(o["g"])("span",{class:"slider round"},null,-1)}));function d(e,t,n,a,r,i){var d=this;return Object(o["m"])(),Object(o["f"])(o["a"],null,[Object(o["g"])("div",c,null,512),Object(o["g"])("div",s,[Object(o["g"])("span",u,"PreviewBox "+Object(o["u"])(this.enablePreview?"Enabled":"Disabled"),1),l,Object(o["g"])("div",null,[Object(o["g"])("label",h,[Object(o["y"])(Object(o["g"])("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=function(e){return d.enablePreview=e})},null,512),[[o["w"],this.enablePreview]]),f])])])],64)}var v=n("d4ec"),p=n("bee2"),m=(n("d81d"),n("bf19"),n("99af"),n("b0c0"),n("e792"),n("f5d5")),b=n("1be2"),y=n("f261"),g=n("1b64"),k=n("def2"),O=n("b85c"),j=n("2909"),w=(n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("faa1")),S=n.n(w),x=["nodedraged","nodeselect","nodeselected"],I=["translatenode","nodetranslate","nodetranslated","selectnode","nodework","nodeworked"];function C(e){var t=new Map;m["c"].Node.prototype.on=function(e,n){t.get(this.id).on(e,n)},m["c"].Node.prototype.removeListener=function(e,n){t.get(this.id).removeListener(e,n)},m["c"].Node.prototype.getListener=function(e){return t.get(this.id)},e.bind("nodework"),e.bind("nodeworked"),m["c"].Engine.prototype.processWorker=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){var o,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.extractInputData(n);case 2:if(o=t.sent,a=this.components.get(n.name),r={},a){t.next=7;break}return t.abrupt("return",r);case 7:return e.trigger("nodework",{node:n,inputData:o}),t.prev=8,t.next=11,a.worker.apply(a,[n,o,r].concat(Object(j["a"])(this.args)));case 11:t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](8),this.abort(),this.trigger("warn",t.t0);case 17:return e.trigger("nodeworked",{node:n,inputData:o,outputData:r}),t.abrupt("return",r);case 19:case"end":return t.stop()}}),t,this,[[8,13]])})));return function(e){return t.apply(this,arguments)}}(),e.on("noderemoved",(function(e){t.get(e.id).emit("noderemoved",e),t.delete(e.id)})),e.on("nodecreated",(function(e){t.has(e.id)||(t.set(e.id,new S.a),console.log(t,e,"add"))})),e.on("rendernode",(function(e){var n=e.node;t.has(n.id)||(t.set(n.id,new S.a),console.log(t,n,"addr")),t.get(n.id).emit("rendernode",e)}));var n,o=Object(O["a"])(x);try{var a=function(){var o=n.value;e.on(o,(function(e){t.get(e.id).emit(o,e)}))};for(o.s();!(n=o.n()).done;)a()}catch(u){o.e(u)}finally{o.f()}var i,c=Object(O["a"])(I);try{var s=function(){var n=i.value;e.on(n,(function(e){t.get(e.node.id).emit(n,e)}))};for(c.s();!(i=c.n()).done;)s()}catch(u){c.e(u)}finally{c.f()}}var T={name:"sub-event",install:C},_=n("262e"),N=n("2caf"),M=function(e){return Object(o["o"])("data-v-36c3bdb3"),e=e(),Object(o["n"])(),e},P={style:{display:"inline",float:"right"}},D=M((function(){return Object(o["g"])("svg",{fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",style:{"enable-background":"new 0 0 30 30"},version:"1.1",viewBox:"0 0 30 30","xml:space":"preserve"},[Object(o["g"])("path",{d:"M24,13.328V24H6V10h10.672l6-6H6C4.895,4,4,4.895,4,6v18c0,1.105,0.895,2,2,2h18c1.105,0,2-0.895,2-2V11.329L24,13.328z"}),Object(o["g"])("g",null,[Object(o["g"])("path",{d:"M28.957,5.543l0.525-0.525c0.69-0.69,0.69-1.81,0-2.5s-1.81-0.69-2.5,0l-0.525,0.525L28.957,5.543z"})]),Object(o["g"])("g",null,[Object(o["g"])("polygon",{points:"25.043,4.457 14.475,15.025 14,18 16.975,17.525 27.543,6.957  "})])],-1)})),V=[D],L={key:0,title:"Keep the preview existing",fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"100%",height:"100%",style:{}},z=M((function(){return Object(o["g"])("path",{d:"M 15 2 C 11.145666 2 8 5.1456661 8 9 L 8 11 L 6 11 C 4.895 11 4 11.895 4 13 L 4 25 C 4 26.105 4.895 27 6 27 L 24 27 C 25.105 27 26 26.105 26 25 L 26 13 C 26 11.895 25.105 11 24 11 L 22 11 L 22 9 C 22 5.2715823 19.036581 2.2685653 15.355469 2.0722656 A 1.0001 1.0001 0 0 0 15 2 z M 15 4 C 17.773666 4 20 6.2263339 20 9 L 20 11 L 10 11 L 10 9 C 10 6.2263339 12.226334 4 15 4 z"},null,-1)})),R=[z],E={key:1,title:"Let the preview disappears after some seconds",fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"100%",height:"100%",viewBox:"0 0 53.768 53.768",style:{"enable-background":"new 0 0 53.768 53.768"},"xml:space":"preserve"},A=M((function(){return Object(o["g"])("g",null,[Object(o["g"])("path",{d:"M39.714,23.75h-2.08h-20.5V6.669C17.134,4.094,19.228,2,21.803,2h10.161c2.574,0,4.67,2.094,4.67,4.669v7.235\r\n\t\tc0,0.553,0.447,1,1,1s1-0.447,1-1V6.669c0-3.678-2.992-6.669-6.67-6.669H21.803c-3.678,0-6.669,2.991-6.669,6.669V23.75h-1.081\r\n\t\tc-3.678,0-6.669,2.991-6.669,6.669v16.679c0,3.678,2.991,6.67,6.669,6.67h25.661c3.678,0,6.67-2.992,6.67-6.67V30.419\r\n\t\tC46.384,26.741,43.392,23.75,39.714,23.75z M44.384,47.098c0,2.574-2.096,4.67-4.67,4.67H14.053c-2.575,0-4.669-2.096-4.669-4.67\r\n\t\tV30.419c0-2.575,2.094-4.669,4.669-4.669h2.081h21.5h2.08c2.574,0,4.67,2.094,4.67,4.669V47.098z"})],-1)})),B=[A],W={key:2,title:"Create a new group of nodes, and change the preset to the new group",fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg",height:"100%",viewBox:"0 0 24 24",width:"100%"},F=M((function(){return Object(o["g"])("path",{d:"M13,3 L5,3 L5,21 L15,21 L15,23 L5,23 C3.8954305,23 3,22.1045695 3,21 L3,3 C3,1.8954305 3.8954305,1 5,1 L15.4142136,1 L21,6.58578644 L21,14 L19,14 L19,9 L15,9 C13.8954305,9 13,8.1045695 13,7 L13,3 Z M19,19 L19,17 L21,17 L21,19 L23,19 L23,21 L21,21 L21,23 L19,23 L19,21 L17,21 L17,19 L19,19 Z M18.5857864,7 L15,3.41421356 L15,7 L18.5857864,7 Z","fill-rule":"evenodd"},null,-1)})),$=[F];function U(e,t,n,a,r,i){var c=this,s=Object(o["s"])("Scene3D");return Object(o["m"])(),Object(o["f"])("div",null,[Object(o["g"])("div",{class:Object(o["k"])("node preview "+this.nodeStyle.nodeStyle.classInfo.value),style:Object(o["l"])([this.nodeStyle.nodeStyle.styleInfo.value,{width:"135px",height:"100px"}])},[Object(o["g"])("div",P,["apply"==this.state.value?(Object(o["m"])(),Object(o["f"])("button",{key:0,class:"button preview-lock-button2",title:"Apply the parameter set to original nodes",onClick:t[0]||(t[0]=function(e){return c.onclick2()})},V)):Object(o["e"])("",!0),Object(o["g"])("button",{class:Object(o["k"])("button preview-lock-button "+this.state.value),onClick:t[1]||(t[1]=function(e){return c.onclick()})},["lock"==this.state.value?(Object(o["m"])(),Object(o["f"])("svg",L,R)):Object(o["e"])("",!0),"unlock"==this.state.value?(Object(o["m"])(),Object(o["f"])("svg",E,B)):Object(o["e"])("",!0),"apply"==this.state.value?(Object(o["m"])(),Object(o["f"])("svg",W,$)):Object(o["e"])("",!0)],2)]),Object(o["i"])(s,{ref:"p1",style:{width:"100px",height:"100px",margin:"3px"},modelStore:this.modelStore},null,8,["modelStore"])],6)])}var H={ref:"canvas",class:"three-js-render-area"};function K(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])("div",H,null,512)}n("6062");var Y,G=n("5a89"),Z=n("a5d4"),X=new G["MeshStandardMaterial"]({side:G["FrontSide"],color:"hsl(0, 100%, 50%)",wireframe:!1}),q=new G["BoxGeometry"](100,100,100),J=[new G["Mesh"](q,X)],Q=new G["PerspectiveCamera"](75,1,.1,1e3),ee=new G["DirectionalLight"]("hsl(0, 100%, 100%)"),te=new Set;function ne(e){Y=new G["WebGLRenderer"]({antialias:!0,canvas:e,alpha:!0}),Y.setClearColor(0,0),requestAnimationFrame(ie)}function oe(){var e,t=Object(O["a"])(te);try{for(t.s();!(e=t.n()).done;){var n=e.value;ae(n.eles.scene,n.eles.camera,n.dom)}}catch(o){t.e(o)}finally{t.f()}}function ae(e,t,n){var o=n.getBoundingClientRect(),a=o.left,r=o.right,i=o.top,c=o.bottom,s=o.width,u=o.height,l=c<0||i>Y.domElement.clientHeight||r<0||a>Y.domElement.clientWidth;if(!l){t.aspect=s/u,t.updateProjectionMatrix();var h=Y.domElement.clientHeight-c;Y.setScissor(a,h,s,u),Y.setViewport(a,h,s,u),e.background=null,Y.render(e,t)}}function re(e){var t=e.domElement,n=t.clientWidth,o=t.clientHeight,a=t.width!==n||t.height!==o;return a&&e.setSize(n,o,!1),a}function ie(){re(Y),Y.setScissorTest(!1),Y.clear(!0,!0),Y.setScissorTest(!0),oe(),requestAnimationFrame(ie)}Q.position.z=0,Q.position.y=0,Q.position.x=200;var ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;Object(v["a"])(this,e),this.dom=null;var n=new G["Scene"],o=new G["AxesHelper"](100);this.eles={scene:n,camera:Q,controls:null,renderer:Y,light:ee,mesh:t,axes:o,speed:.002},this.eles.scene.add(this.eles.camera),this.eles.scene.add(this.eles.axes);var a,r=Object(O["a"])(this.eles.mesh);try{for(r.s();!(a=r.n()).done;){var i=a.value;this.eles.scene.add(i)}}catch(c){r.e(c)}finally{r.f()}this.eles.scene.background=new G["Color"]("rgb(255,255,255)"),this.eles.scene.add(new G["AmbientLight"](new G["Color"](1,1,1)))}return Object(p["a"])(e,[{key:"unmountView",value:function(){this.dom=null,te.remove(this)}},{key:"_setControl",value:function(){this.eles.controls&&delete this.eles.controls,this.eles.controls=null,this.eles.controls=new Z["a"](this.eles.camera,this.dom),this.eles.controls.rotateSpeed=1,this.eles.controls.zoomSpeed=5,this.eles.controls.panSpeed=.8,this.eles.controls.noZoom=!1,this.eles.controls.noPan=!1,this.eles.controls.staticMoving=!0,this.eles.controls.dynamicDampingFactor=.3}},{key:"setSize",value:function(e,t){this.eles.camera.aspect=e/t,this.eles.camera.width=e,this.eles.camera.height=t}},{key:"animate",value:function(){var e=this;this.dom&&(requestAnimationFrame((function(){e.animate()})),this.eles.mesh[0].rotation.y+=this.eles.speed,this.eles.controls.update())}},{key:"mountView",value:function(e){this.dom=e,this.setSize(e.clientWidth,e.clientHeight),this._setControl(),console.log("Add to renderList"),console.log(te),te.add(this)}},{key:"mesh",set:function(e){if(0!=e.length){var t,n=Object(O["a"])(this.eles.mesh);try{for(n.s();!(t=n.n()).done;){var o=t.value;this.eles.scene.remove(o)}}catch(c){n.e(c)}finally{n.f()}var a,r=Object(O["a"])(e);try{for(r.s();!(a=r.n()).done;){var i=a.value;this.eles.scene.add(i)}}catch(c){r.e(c)}finally{r.f()}this.eles.mesh=e}else console.log("ignore empty mesh")}}]),e}(),se=ce,ue=new Map,le={name:"Scene3D",data:function(){return{}},props:["modelStore"],created:function(){},mounted:function(){var e=new se;this.$nextTick((function(){ue.set(this.$refs.canvas,e),e.mountView(this.$refs.canvas),e.animate()}))},beforeUnmount:function(){ue.delete(this.$refs.canvas)},methods:{},watch:{modelStore:{handler:function(e,t){if(e){var n=this,a=function t(){console.log("update scene3D modelStore");var a=ue.get(n.$refs.canvas);null!=a?a.mesh=Object(o["v"])(e).objects:n.$nextTick(t)};a()}},immediate:!0}},computed:{}},he=(n("0722"),n("6b0d")),fe=n.n(he);const de=fe()(le,[["render",K],["__scopeId","data-v-35c14c58"]]);var ve=de,pe=n("53ca"),me=(n("07ac"),n("ade3")),be=n("3835");n("25f0"),n("10d1"),n("a630"),n("4d63"),n("c607"),n("ac1f"),n("2c3e"),n("5377"),n("b64b"),n("5319");function ye(e){if("number"==typeof e)return e;var t=parseFloat(e);return t||0}function ge(e){var t=[];for(var n in e)t[n]=ye(e[n]);return t}function ke(e){var t=null;if(e instanceof G["Float32BufferAttribute"]||e instanceof G["BufferAttribute"])switch(e.itemSize){case 1:t="float";break;case 2:case 3:case 4:t="vec".concat(e.itemSize);break;default:console.log("buffer itemSize>4, this should not happen >"+e.itemSize),console.log(e);break}else console.log("Not implemented! for other type of buffer attribute");return t}function Oe(e){while(e.firstElementChild)e.firstElementChild.remove()}function je(e){var t=e.toString();return-1==t.indexOf(".")?t+=".0f":t+="f",t}function we(e,t,n){return(t-e)*n+e}function Se(e,t,n){result=[];for(var o=e.length(),a=0;a<o;a++)result.push(we(e[a],t[a],n));return result}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakMap;if(Object(e)!==e)return e;if(t.has(e))return t.get(e);var n=e instanceof Set?new Set(e):e instanceof Map?new Map(Array.from(e,(function(e){var n=Object(be["a"])(e,2),o=n[0],a=n[1];return[o,xe(a,t)]}))):e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):null;if(!n){if("function"==typeof e.clone)return n=e.clone(),t.set(e,n),n;n=e.constructor?new e.constructor:Object.create(null)}return t.set(e,n),Object.assign.apply(Object,[n].concat(Object(j["a"])(Object.keys(e).map((function(n){return Object(me["a"])({},n,xe(e[n],t))})))))}var Ie=function(e){return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(function(e,t){return(t?"-":"")+e.toLowerCase()}))};function Ce(e,t){var n=e[0]-t[0],o=e[1]-t[1];return Math.pow(n*n+o*o,.5)}function Te(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#",o=t;for(var a in e)o=o.replace(n+a+n,e[a].toString());return o}function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#",o=t;for(var a in console.log(e),e)o=o.replace(n+a+n,e[a].toString()),console.log(e[a].toString()),console.log(o);return o}function Ne(e){if("string"==typeof e){var t=De.members[e];return t||(console.log("Undefined type enum > "+e),De.members["null"])}if(!e){console.log("<Undefined Value> for type name");var n=null;return n.b.c=1,De.members["null"]}return e}function Me(e){return"string"==typeof e?e:e.name}var Pe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(v["a"])(this,e),this.type=Ne(t),this._value=n,this.isConstValue="string"!=typeof n}return Object(p["a"])(e,[{key:"toString",value:function(){return this.type.turnVar2String(this)}},{key:"clone",value:function(){return new e(this.type,xe(this.value))}},{key:"value",get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e,this.isConstValue="string"!=typeof value)}},{key:"isEquals",value:function(t){return t instanceof e&&t.value==this.value&&this.type==t.type}}]),e}(),De=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(v["a"])(this,e),this.name=t,this.implicitTransform={},e.members[t]=this,this.toStringFunc=n}return Object(p["a"])(e,[{key:"turnVar2String",value:function(e){var t=e.value;return"string"==typeof t?t:this.toStringFunc?this.toStringFunc(t):"".concat(t)}},{key:"addImplicitTransform",value:function(e,t,n){this.implicitTransform[Me(e)]=new Ve("$"+e+">"+this.name,{input:e},this,t,n)}},{key:"toString",value:function(){return this.name}},{key:"tryTransform",value:function(e){var t=this.implicitTransform[e.type];return t?t.execute({input:e}):null}}]),e}();De.members={},De.isCompact=function(e,t){return!!Ne(e).implicitTransform[Me(t)]},De.define=function(e,t){new De(e,t)},De.defineImplicit=function(e,t,n,o){De.members[t].addImplicitTransform(e,n,o)};var Ve=function(){function e(t,n,o,a,r){for(var i in Object(v["a"])(this,e),this.name=t,this.inputs=n,this.inputs)this.inputs[i]=Ne(this.inputs[i]);this.outputType=Ne(o),this.func=a,this.grammar=r}return Object(p["a"])(e,[{key:"execute",value:function(e){return Le(e,this.func,this.outputType,this.grammar)}}]),e}();function Le(e,t,n,o){console.log(e),console.log(Object.values(e));for(var a=Object.values(e),r=0,i=a;r<i.length;r++){var c=i[r];if(!c.isConstValue)return new Pe(n,_e(e,o))}return new Pe(n,t.apply(void 0,Object(j["a"])(a.map((function(e){return e.value})))))}Ve.matchMethod=function(e,t,n){var o,a=Object(O["a"])(e);try{for(a.s();!(o=a.n()).done;){var r=o.value;if(r.name==t){var i=!0;for(var c in n){var s=Ne(n[c].type),u=Ne(r.inputs[c]);if(void 0==Object(pe["a"])(s)||void 0==Object(pe["a"])(u)){i=!1;break}if(s!=u){i=!1;break}}if(i)return r}}}catch(l){a.e(l)}finally{a.f()}return null},Ve.matchMethods=function(e,t,n){var o,a=[],r=Object(O["a"])(e);try{for(r.s();!(o=r.n()).done;){var i=o.value;if(i.name==t){var c=!0;for(var s in n){var u=Ne(n[s].type),l=Ne(i.inputs[s]);if(void 0==Object(pe["a"])(u)||void 0==Object(pe["a"])(l)){c=!1;break}if(u!=l){c=!1;break}}c&&a.push(i)}}}catch(h){r.e(h)}finally{r.f()}return a},Ve.matchPartMethods=function(e,t,n){var o,a=[],r=[],i=Object(O["a"])(e);try{for(i.s();!(o=i.n()).done;){var c=o.value;if(c.name==t||null==t){var s=!0,u=!1;for(var l in c.inputs)if(n[l]){var h=Ne(n[l].type),f=Ne(c.inputs[l]);if(void 0==Object(pe["a"])(h)||void 0==Object(pe["a"])(f)){s=!1;break}if(u=u||"null"==h.name,h!=f&&"null"!=h.name){s=!1;break}}else u=!0;s&&(u?r.push(c):a.push(c))}}}catch(d){i.e(d)}finally{i.f()}return{fullMatch:a,nullMatch:r,allMatch:[].concat(a,r)}},Ve.gatherMethodsTypeSet=function(e,t){var n,o,a=new Set,r=Object(O["a"])(e);try{for(r.s();!(o=r.n()).done;){var i=o.value;n=""==t?i.outputType:i.inputs[t],n&&a.add(n.name)}}catch(c){r.e(c)}finally{r.f()}return a};var ze="_",Re=new Set(["position","normal","uv","color"]),Ee=function(){function e(){var t=this;Object(v["a"])(this,e),this.mesh=null,this.fragShaderText="",this.vertShaderText="",this.map=null,this.uniforms={time:{value:1},ourTexture:null};var o=new G["TextureLoader"];this.errorTexture=null,o.load(n("8499"),(function(e){t.errorTexture=e}))}return Object(p["a"])(e,[{key:"makeShaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;console.log("Shader info"),console.log(this.vertShaderText),console.log("--"),console.log(this.fragShaderText);var t=new G["ShaderMaterial"]({uniforms:G["UniformsUtils"].merge([{ourTexture:{type:"t",value:this.errorTexture}}]),vertexShader:this.vertShaderText,fragmentShader:this.fragShaderText,map:e});return t}},{key:"_genVertShader",value:function(){var e=this.mesh,t=e.geometry.attributes,n=this._generateUniformHeader(),o=e.material.map;for(var a in!0|o&&(n+="                uniform sampler2D ourTexture;\n"),n+=this._genenrateBufferInput(e,"attribute","",Re),n+=this._genenrateBufferInput(e,"varying",ze),n+="void main() {\n",t)n+="".concat(a).concat(ze," = ").concat(a,";\n");return n+="gl_Position = projectionMatrix * (modelViewMatrix * vec4( position, 1.0 ));\n",n+="}\n",n}},{key:"_genFragShader",value:function(e){var t=this._generateFragShaderHeader(this.mesh);return t+="void main(){\n  gl_FragColor = "+e+";\n}",t}},{key:"fragShader",set:function(e){if(this.mesh){console.log("Begin Compile");var t="";if(e instanceof Pe)switch(e.type.name){case"vec4":t="vec4(".concat(e.value,")");break;case"vec3":t="vec4(".concat(e.value,",1.0f)");break;case"vec2":t="vec4(".concat(e.value,",0.0f,1.0f)");break;case"float":var n=e.isConstValue?je(e.value):e.value;t="vec4(".concat(n,",").concat(n,",").concat(n,",1.0f)");break;case"texture2D":t="vec4(0.0f,0.0f,0.0f,0.0f)";break;default:console.log("Unhandled final type "+e.type),console.log(e);break}else"string"==typeof e?t="vec4(".concat(e,")"):"number"==typeof e?t="vec4(vec3(".concat(je(e),"),1.0f)"):(console.log("Unhandled final result"),t="vec4(0.0f,0.0f,0.0f,0.0f)",console.log(e));this.fragShaderText=this._genFragShader(t),this.vertShaderText=this._genVertShader(),this.newMaterial=this.makeShaders()}else console.log("Not ready, skip compiling")}},{key:"_generateUniformHeader",value:function(e){return"uniform float time;\n"}},{key:"_genenrateBufferInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"varying",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a="",r=e.geometry.attributes;for(var i in r)if(!o||!o.has(i)){var c=r[i],s=ke(c);s?a+="".concat(t," ").concat(s," ").concat(i).concat(n,";\n"):console.log("Unknown type for buffer, ignore")}return a}},{key:"_generateFragShaderHeader",value:function(e){var t=this._generateUniformHeader();console.log("gen mat"),console.log(e),console.log(e.material);var n=e.material.map;return!0|n&&(t+="uniform sampler2D ourTexture;\n"),t+=this._genenrateBufferInput(e,"varying",ze),t}}]),e}(),Ae=Ee,Be={name:"PreviewBox",props:["modelStore","variable","nodeStyle","state","setState","apply"],data:function(){return{displayText:"",matBuilder:new Ae}},components:{Scene3D:ve},mounted:function(){},methods:{buildMat:function(){console.log("======================================"),console.log("Update variable!"),console.log(this.variable),this.matBuilder.fragShader=Object(o["v"])(this.variable),this.modelStore.applyMaterialToAll(Object(o["v"])(this.matBuilder.newMaterial)),console.log("======================================")},onclick:function(){"lock"==this.state.value?this.setState("unlock"):"unlock"==this.state.value?this.setState("lock"):"apply"==this.state.value&&this.apply.func()},onclick2:function(){this.apply.func2()}},updated:function(){},computed:{},watch:{modelStore:{handler:function(e,t){console.log(e,t),e&&(this.matBuilder.mesh=Object(o["v"])(e).sampleMesh,this.buildMat())},immediate:!0,deep:!1},variable:{handler:function(e,t){this.modelStore&&this.buildMat()},immediate:!0,deep:!0}}};n("81de");const We=fe()(Be,[["render",U],["__scopeId","data-v-36c3bdb3"]]);var Fe=We,$e=(n("8710"),n("34ad")),Ue=function(){function e(){Object(v["a"])(this,e),this.meshes={},this.textureMaterialMap={},this.objects=[],this.meshToTexture=new Map}return Object(p["a"])(e,[{key:"roughClone",value:function(){var t=new e;t.objects=[];var n,o=Object(O["a"])(this.objects);try{for(o.s();!(n=o.n()).done;){var a=n.value;t.processGroup(a.clone())}}catch(r){o.e(r)}finally{o.f()}return console.log("clone!!!"),console.log(this),console.log(t),t}},{key:"processGroup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e){console.log(e);var n,o=e.children,a=Object(O["a"])(o);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("Mesh"==r.type){this.meshes[r.uuid]=r;var i=r.material;if(i.map)if(this.meshToTexture.set(r,i.map),this.textureMaterialMap[i.map.uuid]){var c=this.textureMaterialMap[i.map.uuid];c.relatedMesh.push(r)}else this.textureMaterialMap[i.map.uuid]={relatedMesh:[r],texture:i.map};if("ShaderMaterial"==i.type){var s=i.uniforms.ourTexture;s&&s.value&&this.meshToTexture.set(r,s.value)}}else"AmbientLight"==r.type?r.visible=!1:("Group"==r.type||"Object3D"==r.type)&&this.processGroup(r,t+1)}}catch(u){a.e(u)}finally{a.f()}0==t&&this.objects.push(e),console.log(this.objects),console.log(this.textureMaterialMap)}}},{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=new G["LoadingManager"];n&&(o.onLoad=n);var a=new $e["a"](o);a.load(e,(function(e){t.processGroup(e.scene)}),(function(e){console.log(e.loaded/e.total*100+"% loaded")}),(function(e){console.log(e)}))}},{key:"sampleMesh",get:function(){for(var e=0,t=Object.values(this.meshes);e<t.length;e++){var n=t[e];return n}return null}},{key:"applyMaterialToAll",value:function(e){new Set;console.log(this.meshes),console.log(e);for(var t=0,n=Object.values(this.meshes);t<n.length;t++){var o=n[t],a=e.clone(),r=this.meshToTexture.get(o);a.uniforms.ourTexture.value=r,a.uniforms.uniformsNeedUpdate=!0,o.material=a}}}]),e}(),He=Ue,Ke=n("45eb"),Ye=n("7e84"),Ge=(n("7db0"),n("d9e2"),["readonly","value"]);function Ze(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])("input",{step:"0.1",type:"number",readonly:n.readonly,value:r.value,onInput:t[0]||(t[0]=function(e){return i.change(e)}),onDblclick:t[1]||(t[1]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[2]||(t[2]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[3]||(t[3]=Object(o["z"])((function(){}),["stop"]))},null,40,Ge)}var Xe={name:"VueNumControl",props:["readonly","emitter","ikey","getData","putData"],data:function(){return{value:0}},methods:{change:function(e){this.value=e.target.value},update:function(){var e=parseFloat(this.value);e||(e=0),this.ikey&&this.putData(this.ikey,new Pe("float",e)),this.emitter.trigger("process")}},mounted:function(){this.value=this.getData(this.ikey),this.value?this.putData(this.ikey,new Pe("float",this.value)):(this.value=0,this.putData(this.ikey,new Pe("float",0)))},watch:{value:{handler:function(e,t){this.update()},immediate:!0}}};const qe=fe()(Xe,[["render",Ze]]);var Je=qe,Qe=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r;return Object(v["a"])(this,n),r=t.call(this,o),r.component=Je,r.props={emitter:e,ikey:o,readonly:a},r}return Object(p["a"])(n,[{key:"setValue",value:function(e){console.log("set val",e),this.vueContext.value=e}}]),n}(m["c"].Control),et=Qe;n("b680");function tt(){De.define("any"),De.define("null"),De.define("float",(function(e){return je(e)})),De.define("int"),De.define("texture2D"),De.define("vec2",(function(e){return"vec2(".concat(je(e[0]),",").concat(je(e[1]),")")})),De.define("vec3",(function(e){return"vec3(".concat(je(e[0]),",").concat(je(e[1]),",").concat(je(e[2]),")")})),De.define("vec4",(function(e){return"vec4(".concat(je(e[0]),",").concat(je(e[1]),",").concat(je(e[2]),",").concat(je(e[3]),")")})),De.defineImplicit("float","int",(function(e){return e.toFixed(0)}),"int(#input#)"),De.defineImplicit("int","float",(function(e){return e+0}),"float(#input#)"),De.defineImplicit("float","vec2",(function(e){return[e,e]}),"vec2(#input#)")}function nt(){for(var e in console.log(De),De.members)De.members[e].reteSocket=new m["c"].Socket(e);for(var t in De.members){var n=De.members[t],o=n.implicitTransform;for(var a in o)De.members[a].reteSocket.combineWith(n.reteSocket);n.reteSocket.combineWith(De.members["any"].reteSocket)}}function ot(e){var t=De.members[e];return t?t.reteSocket:(console.log("Unknown Socket Type > "+e),asd,null)}tt(),nt();var at={class:"title"},rt={class:"content"},it={key:0,class:"col"},ct={class:"col"},st={class:"output-title"},ut={key:0,class:"error-info",style:{display:"inline-block",width:"200px"}};function lt(e,t,n,a,r,i){var c=this,s=Object(o["s"])("Socket"),u=Object(o["t"])("socket"),l=Object(o["t"])("control");return Object(o["m"])(),Object(o["f"])("div",{class:Object(o["k"])(this.nodeClass),style:Object(o["l"])(this.node.styleInfo.nodeStyle.styleInfo.value)},[Object(o["g"])("div",at,Object(o["u"])(e.node.name),1),Object(o["g"])("div",rt,[e.node.controls.size>0||e.node.inputs.size>0?(Object(o["m"])(),Object(o["f"])("div",it,[(Object(o["m"])(!0),Object(o["f"])(o["a"],null,Object(o["r"])(e.inputs(),(function(e){return Object(o["m"])(),Object(o["f"])("div",{class:"input",key:e.key,style:{"text-align":"left"}},[Object(o["y"])(Object(o["i"])(s,{type:"input",socket:e.socket,used:function(){return e.connections.length},"socket-style-info":c.node.styleInfo.socketsStyle.get(e),"socket-dynamic-info":c.getSocketDynamicInfoString(e)},null,8,["socket","used","socket-style-info","socket-dynamic-info"]),[[u,e,"input"]]),Object(o["y"])(Object(o["g"])("div",{class:"input-title"},Object(o["u"])(e.name),513),[[o["x"],!e.showControl()]]),Object(o["y"])(Object(o["g"])("div",{class:Object(o["k"])("input-control "+c.getControlClass(e.control)),style:Object(o["l"])(c.getControlStyle(e.control))},null,6),[[o["x"],e.showControl()],[l,e.control]])])})),128)),(Object(o["m"])(!0),Object(o["f"])(o["a"],null,Object(o["r"])(e.controls(),(function(e){return Object(o["y"])((Object(o["m"])(),Object(o["f"])("div",{key:e,class:Object(o["k"])("control "+c.getControlClass(e)),style:Object(o["l"])(c.getControlStyle(e))},null,6)),[[l,e]])})),128))])):Object(o["e"])("",!0),Object(o["g"])("div",ct,[(Object(o["m"])(!0),Object(o["f"])(o["a"],null,Object(o["r"])(e.outputs(),(function(e){return Object(o["m"])(),Object(o["f"])("div",{class:"output",key:e.key,style:{"text-align":"right"}},[Object(o["g"])("div",st,Object(o["u"])(e.name),1),Object(o["y"])(Object(o["i"])(s,{type:"output",socket:e.socket,used:function(){return e.connections.length},"socket-style-info":c.node.styleInfo.socketsStyle.get(e),"socket-dynamic-info":c.getSocketDynamicInfoString(e)},null,8,["socket","used","socket-style-info","socket-dynamic-info"]),[[u,e,"output"]])])})),128))])]),""!=this.node.errorInfo_.value?(Object(o["m"])(),Object(o["f"])("p",ut,Object(o["u"])(this.node.errorInfo_.value),1)):Object(o["e"])("",!0)],6)}var ht=["title"];function ft(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])("div",{class:Object(o["k"])(this.socketClass),style:Object(o["l"])(this.socketStyleInfo.styleInfo.value+this.socketStyleExtra),title:this.socket.name+" "+this.socketDynamicInfo},null,14,ht)}var dt={name:"CustomSocket",props:["type","socket","used","socketStyleInfo","socketDynamicInfo"],mixins:[y["a"].Socket],methods:{},computed:{socketClass:function(){return"socket ".concat(Ie(this.type)," ").concat(Ie(this.socket.name)," ").concat(this.used()?"used":""," ").concat(this.socketStyleInfo.classInfo.value)},socketStyleExtra:function(){var e="background-image: conic-gradient(";this.used()&&(e="background-image: conic-gradient(#ffffff 50%,");var t=this.socketDynamicInfo;return-1!=t.indexOf("texture2D")&&(e+="#ff0000,#ff0000,"),-1!=t.indexOf("float")&&(e+="#7777ff,#7777ff,"),-1!=t.indexOf("vec2")&&(e+="#00ffff,#00ffff,"),-1!=t.indexOf("vec3")&&(e+="#ffff00,#ffff00,"),-1!=t.indexOf("vec4")&&(e+="#77ff00,#77ff00,"),e=e.substring(0,e.length-1),e+=");",console.log("style_basic",e),e}}};n("0bb0");const vt=fe()(dt,[["render",ft]]);var pt=vt;console.log(y["a"].mixin);var mt={name:"CustomNode",mixins:[y["a"].Node],methods:{used:function(e){return e.connections.length},getControlClass:function(e){return e?this.node.styleInfo.getControl(e).classInfo.value:""},getControlStyle:function(e){return e?this.node.styleInfo.getControl(e).styleInfo.value:""},getSocketDynamicInfoString:function(e){var t=""+e.socket.name,n=e.possibleSocketTemp;if(n||(n=e.possibleSocket),n){var o,a=Object(O["a"])(n.values());try{for(a.s();!(o=a.n()).done;){var r=o.value;t+=" "+r.name}}catch(i){a.e(i)}finally{a.f()}}return t},getSocketDynamicInfoList:function(e){if(e.possibleSocket){var t,n=[],o=Object(O["a"])(e.possibleSocket.values());try{for(o.s();!(t=o.n()).done;){var a=t.value;n.push(a.name)}}catch(r){o.e(r)}finally{o.f()}return n}return[]}},computed:{nodeClass:function(){return console.log("node ".concat(this.selected()," ").concat(Ie(this.node.name)," ")+this.node.styleInfo.nodeStyle.classInfo.value),"node ".concat(this.selected()," ").concat(Ie(this.node.name)," ").concat(this.node.styleInfo.nodeStyle.classInfo.value)}},components:{Socket:pt}};n("a2fa");const bt=fe()(mt,[["render",lt]]);var yt=bt,gt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(v["a"])(this,e),this.classInfo=Object(o["q"])(t),this.styleInfo=Object(o["q"])(n)}return Object(p["a"])(e,[{key:"addClass",value:function(e){-1==this.classInfo.value.indexOf(e)&&(this.classInfo.value+=" ".concat(e))}},{key:"removeClass",value:function(e){this.classInfo.value=this.classInfo.value.replace(" ".concat(e),"")}},{key:"addStyle",value:function(e){this.styleInfo.value+=";".concat(e)}},{key:"removeStyle",value:function(e){this.styleInfo.value=this.styleInfo.value.replace(";".concat(e),"")}}]),e}();function kt(){return new gt}var Ot=function(){function e(){Object(v["a"])(this,e),this.nodeStyle=kt(),this.socketsStyle=new Map,this.controlsStyle=new Map}return Object(p["a"])(e,[{key:"applyNode",value:function(e){var t,n=Object(O["a"])(e.inputs.values());try{for(n.s();!(t=n.n()).done;){var o=t.value;this.addSocket(o),this.addControl(o.control)}}catch(l){n.e(l)}finally{n.f()}var a,r=Object(O["a"])(e.outputs.values());try{for(r.s();!(a=r.n()).done;){var i=a.value;this.addSocket(i),this.addControl(i.control)}}catch(l){r.e(l)}finally{r.f()}var c,s=Object(O["a"])(e.controls.values());try{for(s.s();!(c=s.n()).done;){var u=c.value;this.addControl(u)}}catch(l){s.e(l)}finally{s.f()}}},{key:"genControlID",value:function(e){return"".concat(e.parent.id,"_").concat(e.key)}},{key:"addControl",value:function(e){if(e){var t=this.genControlID(e);this.controlsStyle.set(t,kt())}}},{key:"getControl",value:function(e){return this.controlsStyle.get(this.genControlID(e))}},{key:"addSocket",value:function(e){this.socketsStyle.set(e,kt())}},{key:"clone",value:function(){var t=new e;return t}}]),e}(),jt=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e){var o;return Object(v["a"])(this,n),o=t.call(this,e),o.eventManager=new S.a,o.defaultInput={},o.data.component=yt,o}return Object(p["a"])(n,[{key:"_getSocket",value:function(e){return ot(e)}},{key:"_addInput",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"any",a=new wt(t,n,ot(o));return e.addInput(a),a}},{key:"_addNumSocketInput",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:et,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=new wt(t,n,ot(o));return c.addControl(new a(this.editor,t)),this.defaultInput[t]=i,r&&(c.possibleSocket=r),e.addInput(c),c}},{key:"_addNumSocketOutput",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=new St(t,n,ot(o));return a&&(r.possibleSocket=a),e.addOutput(r),r}},{key:"_textWorker",value:function(e,t){return Te(e,t)}},{key:"_extractInput",value:function(e,t){var n={};for(var o in t)n[o]=this.extractInputKey(e,t,o);return n}},{key:"extractInputKey",value:function(e,t,n){if(t[n].length)return t[n][0];var o=e.data[n];return o||(o=this.defaultInput[n],this.defaultInput[n])?o:(console.warn("Unknown key in _extractInput: "+n),console.log(e),null)}},{key:"addWorkEvent",value:function(e){this.eventManager.on("work",e)}},{key:"removeWorkEvent",value:function(e){this.eventManager.removeListener("work",e)}},{key:"worker",value:function(e,t,n){this.eventManager.emit("work",e,t,n)}},{key:"builder",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createNode",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},n=new xt(this.name),n.data=t,e.next=5,this.build(n);case 5:return n.styleInfo.applyNode(n),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setErrorInfo",value:function(e,t){this.editor.nodes.find((function(t){return t.id==e.id})).errorInfo=t}},{key:"clearErrorInfo",value:function(e){this.setErrorInfo(e,"")}},{key:"getRealNode",value:function(e){return this.editor.nodes.find((function(t){return t.id==e.id}))}}]),n}(m["c"].Component),wt=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object(v["a"])(this,n),r=t.call(this,e,o,a,i),r.hide=!1,r.alwaysShowName=!1,r.possibleSocket=new Set,r.possibleSocketTemp=new Set,r}return Object(p["a"])(n,[{key:"setSocket",value:function(e){this.socket!=e&&("string"==typeof e?e=ot(e):null==e&&(e=ot("null")),this.socket=e)}},{key:"checkConnection",value:function(e){return!0}},{key:"showControl",value:function(){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"showControl",this).call(this)&&!this.hide&&!this.alwaysShowName}}]),n}(m["c"].Input),St=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Object(v["a"])(this,n),r=t.call(this,e,o,a,i),r.hide=!1,r.alwaysShowName=!1,r.possibleSocket=new Set,r.possibleSocketTemp=new Set,r}return Object(p["a"])(n,[{key:"setSocket",value:function(e){this.socket!=e&&("string"==typeof e?e=ot(e):null==e&&(e=ot("null")),this.socket=e)}},{key:"connectTo",value:function(e){if(console.log("Try connection",e,this),!e.multipleConnections&&e.hasConnection())throw new Error("Input already has one connection");if(!this.multipleConnections&&this.hasConnection())throw new Error("Output already has one connection");var t,n=!1,o=Object(O["a"])(this.possibleSocket.values());try{for(o.s();!(t=o.n()).done;){var a,r=t.value,i=Object(O["a"])(e.possibleSocket.values());try{for(i.s();!(a=i.n()).done;){var c=a.value;if(r.compatibleWith(c)){n=!0;break}}}catch(p){i.e(p)}finally{i.f()}if(n)break}}catch(p){o.e(p)}finally{o.f()}if(!n){var s,u=Object(O["a"])(e.possibleSocket.values());try{for(u.s();!(s=u.n()).done;){var l=s.value;if(this.socket.compatibleWith(l)){n=!0;break}}}catch(p){u.e(p)}finally{u.f()}}if(!n){var h,f=Object(O["a"])(this.possibleSocket.values());try{for(f.s();!(h=f.n()).done;){var d=h.value;if(d.compatibleWith(e.socket)){n=!0;break}}}catch(p){f.e(p)}finally{f.f()}}if(!n&&!this.socket.compatibleWith(e.socket))throw new Error("Sockets not compatible");var v=new m["c"].Connection(this,e);return this.connections.push(v),v}},{key:"checkConnection",value:function(e){var t,n=e.input,o=e.output,a=Object(O["a"])(o.possibleSocket.values());try{for(a.s();!(t=a.n()).done;){var r,i=t.value,c=Object(O["a"])(n.possibleSocket.values());try{for(c.s();!(r=c.n()).done;){var s=r.value;if(i.compatibleWith(s))return!0}}catch(p){c.e(p)}finally{c.f()}}}catch(p){a.e(p)}finally{a.f()}var u,l=Object(O["a"])(n.possibleSocket.values());try{for(l.s();!(u=l.n()).done;){var h=u.value;if(o.socket.compatibleWith(h))return!0}}catch(p){l.e(p)}finally{l.f()}var f,d=Object(O["a"])(o.possibleSocket.values());try{for(d.s();!(f=d.n()).done;){var v=f.value;if(v.compatibleWith(n.socket))return!0}}catch(p){d.e(p)}finally{d.f()}return!!o.socket.compatibleWith(n.socket)}},{key:"showControl",value:function(){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"showControl",this).call(this)&&!this.hide&&!this.alwaysShowName}}]),n}(m["c"].Output),xt=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e){var a;return Object(v["a"])(this,n),a=t.call(this,e),a.styleInfo=new Ot,a.errorInfo_=Object(o["q"])(""),a}return Object(p["a"])(n,[{key:"errorInfo",set:function(e){this.errorInfo_.value=e}},{key:"nodeStyle",set:function(e){this.styleInfo.nodeStyle.styleInfo.value=e}},{key:"nodeClass",set:function(e){this.styleInfo.nodeStyle.classInfo.value=e}},{key:"setSocketStyle",value:function(e,t){this.styleInfo.socketsStyle.get(e).styleInfo.value=t}},{key:"setSocketClass",value:function(e,t){this.styleInfo.socketsStyle.get(e).styleClass.value=t}},{key:"addNodeStyle",value:function(e){this.styleInfo.nodeStyle.addStyle(e)}},{key:"removeNodeStyle",value:function(e){this.styleInfo.nodeStyle.removeStyle(e)}},{key:"addNodeClass",value:function(e){this.styleInfo.nodeStyle.addClass(e)}},{key:"removeNodeClass",value:function(e){this.styleInfo.nodeStyle.removeClass(e)}},{key:"addSocketClass",value:function(e,t){this.styleInfo.socketsStyle.get(e).addClass(t)}},{key:"removeSocketClass",value:function(e,t){this.styleInfo.socketsStyle.get(e).removeClass(t)}},{key:"addSocketStyle",value:function(e,t){this.styleInfo.socketsStyle.get(e).addStyle(t)}},{key:"removeSocketStyle",value:function(e,t){this.styleInfo.socketsStyle.get(e).removeStyle(t)}},{key:"addControlClass",value:function(e,t){this.styleInfo.getControl(e).addClass(t)}},{key:"removeControlClass",value:function(e,t){this.styleInfo.getControl(e).removeClass(t)}},{key:"addControlStyle",value:function(e,t){this.styleInfo.getControl(e).addStyle(t)}},{key:"removeControlStyle",value:function(e,t){this.styleInfo.getControl(e).removeStyle(t)}},{key:"setData",value:function(e,t){this.data[e]=t;var n=this.getControl(e);if(n){var o=t instanceof Pe?t.value:t;n.setValue(o)}}},{key:"getControl",value:function(e){return this.controls.has(e)?this.controls.get(e):this.inputs.has(e)?this.inputs.get(e).control:null}},{key:"getData",value:function(e){return this.data[e]}}]),n}(m["c"].Node),It=jt,Ct=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"PreviewBox")}return Object(p["a"])(n,[{key:"worker",value:function(e,t,n){}},{key:"builder",value:function(e){return e}},{key:"createNode",value:function(e){var t=new Tt(this.editor);return t.data=e,t}}]),n}(m["c"].Component),Tt=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.defaultWidth,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.defaultHeight;return Object(v["a"])(this,n),e=t.call(this,"PreviewBox"),e.vueContext=null,e.width=a,e.height=r,e.templateData=null,e._variable=Object(o["p"])(new Pe("float",0)),e._state=Object(o["q"])("unlock"),e._applyFunc=Object(o["p"])({func:function(){},func2:function(){}}),e}return Object(p["a"])(n,[{key:"createVueComp",value:function(e){var t=this;console.log("mount!"),console.log(this.data),this.data.modelStore||(this.data.modelStore=new He);var n=Object(o["c"])(Fe,{modelStore:this.data.modelStore,variable:this._variable,nodeStyle:this.styleInfo,state:this._state,setState:function(e){t.state=e},apply:this._applyFunc});n.mount(e),this.el=e}},{key:"applyFunc",set:function(e){this._applyFunc.func=e}},{key:"applyFunc2",set:function(e){this._applyFunc.func2=e}},{key:"variable",set:function(e){Object.assign(this._variable,e)}},{key:"state",get:function(){return this._state.value},set:function(e){this._state.value=e}},{key:"setPosition",value:function(e,t){this.position=t;var n=e.view.nodes.get(this);n&&n.translate(t[0],t[1])}}]),n}(xt);function _t(e){e.on("rendernode",(function(e){var t=e.el,n=e.node,o=e.component,a=e.bindSocket,r=e.bindControl;o.render&&"vue"!==o.render||(console.log({el:t,node:n,component:o,bindSocket:a,bindControl:r}),"PreviewBox"==n.name&&n.createVueComp(t))}))}Tt.defaultWidth=100,Tt.defaultHeight=100;var Nt={name:"preview-box",install:_t},Mt=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Number")}return Object(p["a"])(n,[{key:"builder",value:function(e){Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketOutput(e,"num","Number");var t=new et(this.editor,"num");return e.addControl(t),e}},{key:"worker",value:function(e,t,o){o["num"]=e.data.num,console.log("Output num"),console.log(e.data.num),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Pt=Mt,Dt=function(){function e(t,n,o,a,r,i){Object(v["a"])(this,e),this.name=t,this.inputs=n,this.outputType=o,this.func=a,this.grammar=r,this.templateVar=i}return Object(p["a"])(e,[{key:"specialize",value:function(e){var t={};for(var n in this.inputs)t[n]=Te(e,this.inputs[n]);var o=Te(e,this.outputType),a=Te(e,this.grammar);return new Ve(this.name,t,o,this.func,a)}}]),e}();function Vt(e,t,n){for(var o=["float","vec2","vec3","vec4"],a="#UPTYPE1#(#num#)"+n+"#UPTYPE2#(#num2#)",r=new Dt(e,{num:"#IT1#",num2:"#IT2#"},"#IT3#",(function(e,n){if(e.length&&n.length){var o=[];for(var a in e)o[a]=t(e[a],n[a]);return o}if(!e.length){if(!n.length)return t(e,n);var r=[];for(var i in n)r[i]=t(e,n[i]);return r}if(!n.length){var c=[];for(var s in e)c[s]=t(e[s],n);return c}return t(e,n)}),a),i=[],c=0,s=o;c<s.length;c++){var u=s[c];i.push(r.specialize({IT1:u,IT2:u,IT3:u,UPTYPE1:"",UPTYPE2:""}))}for(var l=["vec2","vec3","vec4"],h=0,f=l;h<f.length;h++){var d=f[h];i.push(r.specialize({IT1:d,IT2:"float",IT3:d,UPTYPE1:"",UPTYPE2:d})),"/"!=n&&i.push(r.specialize({IT1:"float",IT2:d,IT3:d,UPTYPE1:d,UPTYPE2:""}))}return i}function Lt(e){e["add"]=Vt("add",(function(e,t){return e+t}),"+"),e["minus"]=Vt("minus",(function(e,t){return e-t}),"-"),e["mult"]=Vt("mult",(function(e,t){return e*t}),"*"),e["div"]=Vt("div",(function(e,t){return e/t}),"/")}var zt="rgba";function Rt(e){var t,n="",o=Object(O["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;n+=zt[a]}}catch(r){o.e(r)}finally{o.f()}return n}function Et(e,t){var n="#v#.#s#",o=Rt(t),a=e+"_"+o,r="float";o.length>1&&(r="vec".concat(o.length));for(var i=new Dt(a,{v:"#IT#"},"#OT#",(function(e){var n,o=[],a=Object(O["a"])(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;o.push(e[r])}}catch(i){a.e(i)}finally{a.f()}return 1==o.length?o[0]:o}),n),c=[],s=Math.max(2,Math.max.apply(Math,Object(j["a"])(t))+1),u=4;u>=s;u--)c.push("vec".concat(u));for(var l=[],h=0,f=c;h<f.length;h++){var d=f[h];l.push(i.specialize({s:o,IT:d,OT:r}))}return l}function At(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t<0)return e;for(var n=[],o=0;o<4;o++){var a,r=Object(O["a"])(e);try{for(r.s();!(a=r.n()).done;){var i=a.value;n.push(i.concat([o]))}}catch(c){r.e(c)}finally{r.f()}}return At(n,t-1)}function Bt(e,t){var n,o=Object(O["a"])(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;e.push(a)}}catch(r){o.e(r)}finally{o.f()}return e}function Wt(e){var t=[],n=[[0],[1],[2],[3]];t=Bt(t,At(n,-1));var o,a=[],r=Object(O["a"])(t);try{for(r.s();!(o=r.n()).done;){var i=o.value;a=Bt(a,Et("extract",i))}}catch(c){r.e(c)}finally{r.f()}e["extract"]=a}function Ft(e){var t=[];t.push(new Ve("numberToVec2",{r:"float",g:"float"},"vec2",(function(e,t){return[e,t]}),"vec2(#r#,#g#)")),t.push(new Ve("numberToVec3",{r:"float",g:"float",b:"float"},"vec3",(function(e,t,n){return[e,t,n]}),"vec3(#r#,#g#,#b#)")),t.push(new Ve("numberToVec4",{r:"float",g:"float",b:"float",a:"float"},"vec4",(function(e,t,n,o){return[e,t,n,o]}),"vec4(#r#,#g#,#b#,#a#)")),e["varying"]=t}function $t(e,t){for(var n=0,o=0;o<e.length;o++)n+=e[o]*t[o];return n}function Ut(e){var t=[];t.push(new Ve("dot",{a:"float",b:"float"},"float",(function(e,t){return e*t}),"#a#*#b#")),t.push(new Ve("dot",{a:"vec2",b:"vec2"},"float",(function(e,t){return $t(e,t)}),"dot(#a#,#b#)")),t.push(new Ve("dot",{a:"vec3",b:"vec3"},"float",(function(e,t){return $t(e,t)}),"dot(#a#,#b#)")),t.push(new Ve("dot",{a:"vec4",b:"vec4"},"float",(function(e,t){return $t(e,t)}),"dot(#a#,#b#)")),e["dot"]=t}function Ht(e){for(var t=new Dt("setp",{v1:"#IT1#",v2:"#IT2#"},"#OT#",(function(e,t){if(!e.length&&!t.length)return e>t?1:0;var n=[];if(e.length&&t.length)for(var o=0;o<e.length;o++)n.push(e[o]>t[o]?1:0);if(!e.length&&t.length)for(var a=0;a<t.length;a++)n.push(e>t[a]?1:0);if(e.length&&!t.length)for(var r=0;r<e.length;r++)n.push(e[r]>t?1:0);return n}),"step(#v1#,#v2#)"),n=["float","vec2","vec3","vec4"],o=["vec2","vec3","vec4"],a=[],r=0,i=n;r<i.length;r++){var c=i[r];a.push(t.specialize({IT1:c,IT2:c,OT:c}))}for(var s=0,u=o;s<u.length;s++){var l=u[s];a.push(t.specialize({IT1:"float",IT2:l,OT:l}))}e["step"]=a}function Kt(e){for(var t=function(e,t,n){return e*(1-n)+t*n},n=new Dt("mix",{v1:"#IT1#",v2:"#IT2#",v3:"#IT3#"},"#OT#",(function(e,n,o){if(!e.length&&!n.length&&!o.length)return t(e,n,o);var a=[];if(e.length&&n.length&&o.length)for(var r=0;r<e.length;r++)a.push(t(e[r],n[r],o[r]));if(e.length&&n.length&&!o.length)for(var i=0;i<e.length;i++)a.push(t(e[i],n[i],o));return a}),"mix(#v1#,#v2#,#v3#)"),o=["float","vec2","vec3","vec4"],a=["vec2","vec3","vec4"],r=[],i=0,c=o;i<c.length;i++){var s=c[i];r.push(n.specialize({IT1:s,IT2:s,IT3:s,OT:s}))}for(var u=0,l=a;u<l.length;u++){var h=l[u];r.push(n.specialize({IT1:h,IT2:h,IT3:"float",OT:h}))}e["mix"]=r}function Yt(e){for(var t=new Dt("max",{v1:"#IT1#",v2:"#IT2#"},"#OT#",(function(e,t){if(!e.length&&!t.length)return e>t?e:t;var n=[];if(e.length&&t.length)for(var o=0;o<e.length;o++)n.push(e[o]>t[o]?e[o]:t[o]);if(!e.length&&t.length)for(var a=0;a<t.length;a++)n.push(e>t[a]?e:t[a]);if(e.length&&!t.length)for(var r=0;r<e.length;r++)n.push(e[r]>t?e[r]:t);return n}),"max(#v1#,#v2#)"),n=["float","vec2","vec3","vec4"],o=["vec2","vec3","vec4"],a=[],r=0,i=n;r<i.length;r++){var c=i[r];a.push(t.specialize({IT1:c,IT2:c,OT:c}))}for(var s=0,u=o;s<u.length;s++){var l=u[s];a.push(t.specialize({IT1:l,IT2:"float",OT:l}))}e["max"]=a}function Gt(e){for(var t=new Dt("min",{v1:"#IT1#",v2:"#IT2#"},"#OT#",(function(e,t){if(!e.length&&!t.length)return e<t?e:t;var n=[];if(e.length&&t.length)for(var o=0;o<e.length;o++)n.push(e[o]<t[o]?e[o]:t[o]);if(!e.length&&t.length)for(var a=0;a<t.length;a++)n.push(e<t[a]?e:t[a]);if(e.length&&!t.length)for(var r=0;r<e.length;r++)n.push(e[r]<t?e[r]:t);return n}),"min(#v1#,#v2#)"),n=["float","vec2","vec3","vec4"],o=["vec2","vec3","vec4"],a=[],r=0,i=n;r<i.length;r++){var c=i[r];a.push(t.specialize({IT1:c,IT2:c,OT:c}))}for(var s=0,u=o;s<u.length;s++){var l=u[s];a.push(t.specialize({IT1:l,IT2:"float",OT:l}))}e["min"]=a}function Zt(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;o||(o=t);for(var a=new Dt(t,{v1:"#IT1#",v2:"#IT2#"},"#OT#",(function(e,t){if(!e.length&&!t.length)return n(e,t);var o=[];if(e.length&&t.length)for(var a=0;a<e.length;a++)o.push(n(e[a],t[a]));return o}),o+"(#v1#,#v2#)"),r=["float","vec2","vec3","vec4"],i=[],c=0,s=r;c<s.length;c++){var u=s[c];i.push(a.specialize({IT1:u,IT2:u,OT:u}))}e[t]=i}var Xt={};Lt(Xt),Wt(Xt),Ft(Xt),Ut(Xt),Ht(Xt),Kt(Xt),Yt(Xt),Gt(Xt),Zt(Xt,"pow",(function(e,t){return Math.pow(e,t)})),Zt(Xt,"sin",(function(e,t){return Math.sin(e,t)})),Zt(Xt,"cos",(function(e,t){return Math.cos(e,t)})),Zt(Xt,"tan",(function(e,t){return Math.tan(e,t)})),console.log("FullMethods",Xt);var qt=n("257e"),Jt=["readonly","value"],Qt=["readonly","value"];function en(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])(o["a"],null,[Object(o["g"])("input",{step:"0.1",ref:"x",type:"number",placeholder:"X",readonly:n.readonly,value:r.value[0],onInput:t[0]||(t[0]=function(e){return i.change(e)}),onDblclick:t[1]||(t[1]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[2]||(t[2]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[3]||(t[3]=Object(o["z"])((function(){}),["stop"]))},null,40,Jt),Object(o["g"])("input",{step:"0.1",ref:"y",type:"number",placeholder:"Y",readonly:n.readonly,value:r.value[1],onInput:t[4]||(t[4]=function(e){return i.change(e)}),onDblclick:t[5]||(t[5]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[6]||(t[6]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[7]||(t[7]=Object(o["z"])((function(){}),["stop"]))},null,40,Qt)],64)}var tn={name:"VueNumControl",props:["readonly","emitter","ikey","getData","putData"],data:function(){return{value:[0,0]}},methods:{change:function(e){this.value=[this.$refs.x.value,this.$refs.y.value],this.update()},update:function(){var e=ge([this.value[0],this.value[1]]);this.ikey&&this.putData(this.ikey,new Pe("vec2",Object(o["v"])(e))),this.emitter.trigger("process")}},mounted:function(){this.value=this.getData(this.ikey),this.value?this.putData(this.ikey,new Pe("vec2",Object(o["v"])(this.value))):(this.value=[0,0],this.putData(this.ikey,new Pe("vec2",[0,0])))}};n("e6d9");const nn=fe()(tn,[["render",en],["__scopeId","data-v-13a8162a"]]);var on=nn,an=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r;return Object(v["a"])(this,n),r=t.call(this,o),r.component=on,r.props={emitter:e,ikey:o,readonly:a},r}return Object(p["a"])(n,[{key:"setValue",value:function(e){this.vueContext.value=e}}]),n}(m["c"].Control),rn=an,cn=["readonly","value"],sn=["readonly","value"],un=["readonly","value"];function ln(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])(o["a"],null,[Object(o["g"])("input",{step:"0.1",ref:"x",type:"number",placeholder:"X",readonly:n.readonly,value:r.value[0],onInput:t[0]||(t[0]=function(e){return i.change(e)}),onDblclick:t[1]||(t[1]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[2]||(t[2]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[3]||(t[3]=Object(o["z"])((function(){}),["stop"]))},null,40,cn),Object(o["g"])("input",{step:"0.1",ref:"y",type:"number",placeholder:"Y",readonly:n.readonly,value:r.value[1],onInput:t[4]||(t[4]=function(e){return i.change(e)}),onDblclick:t[5]||(t[5]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[6]||(t[6]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[7]||(t[7]=Object(o["z"])((function(){}),["stop"]))},null,40,sn),Object(o["g"])("input",{step:"0.1",ref:"z",type:"number",placeholder:"Z",readonly:n.readonly,value:r.value[2],onInput:t[8]||(t[8]=function(e){return i.change(e)}),onDblclick:t[9]||(t[9]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[10]||(t[10]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[11]||(t[11]=Object(o["z"])((function(){}),["stop"]))},null,40,un)],64)}var hn={name:"VueNumControl",props:["readonly","emitter","ikey","getData","putData"],data:function(){return{value:[0,0,0]}},methods:{change:function(e){this.value=[this.$refs.x.value,this.$refs.y.value,this.$refs.z.value],this.update()},update:function(){var e=ge([this.value[0],this.value[1],this.value[2]]);this.ikey&&this.putData(this.ikey,new Pe("vec3",Object(o["v"])(e))),this.emitter.trigger("process")}},mounted:function(){this.value=this.getData(this.ikey),this.value?this.putData(this.ikey,new Pe("vec3",Object(o["v"])(this.value))):(this.value=[0,0,0],this.putData(this.ikey,new Pe("vec3",[0,0,0])))}};n("037f");const fn=fe()(hn,[["render",ln],["__scopeId","data-v-f682f51e"]]);var dn=fn,vn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r;return Object(v["a"])(this,n),r=t.call(this,o),r.component=dn,r.props={emitter:e,ikey:o,readonly:a},r}return Object(p["a"])(n,[{key:"setValue",value:function(e){this.vueContext.value=e}}]),n}(m["c"].Control),pn=vn,mn=["readonly","value"],bn=["readonly","value"],yn=["readonly","value"],gn=["readonly","value"];function kn(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])(o["a"],null,[Object(o["g"])("input",{step:"0.1",ref:"x",type:"number",placeholder:"X",readonly:n.readonly,value:r.value[0],onInput:t[0]||(t[0]=function(e){return i.change(e)}),onDblclick:t[1]||(t[1]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[2]||(t[2]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[3]||(t[3]=Object(o["z"])((function(){}),["stop"]))},null,40,mn),Object(o["g"])("input",{step:"0.1",ref:"y",type:"number",placeholder:"Y",readonly:n.readonly,value:r.value[1],onInput:t[4]||(t[4]=function(e){return i.change(e)}),onDblclick:t[5]||(t[5]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[6]||(t[6]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[7]||(t[7]=Object(o["z"])((function(){}),["stop"]))},null,40,bn),Object(o["g"])("input",{step:"0.1",ref:"z",type:"number",placeholder:"Z",readonly:n.readonly,value:r.value[2],onInput:t[8]||(t[8]=function(e){return i.change(e)}),onDblclick:t[9]||(t[9]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[10]||(t[10]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[11]||(t[11]=Object(o["z"])((function(){}),["stop"]))},null,40,yn),Object(o["g"])("input",{step:"0.1",ref:"w",type:"number",placeholder:"W",readonly:n.readonly,value:r.value[3],onInput:t[12]||(t[12]=function(e){return i.change(e)}),onDblclick:t[13]||(t[13]=Object(o["z"])((function(){}),["stop"])),onPointerdown:t[14]||(t[14]=Object(o["z"])((function(){}),["stop"])),onPointermove:t[15]||(t[15]=Object(o["z"])((function(){}),["stop"]))},null,40,gn)],64)}var On={name:"VueNumControl",props:["readonly","emitter","ikey","getData","putData"],data:function(){return{value:[0,0,0,0]}},methods:{change:function(e){this.value=[this.$refs.x.value,this.$refs.y.value,this.$refs.z.value,this.$refs.w.value],this.update()},update:function(){var e=ge([this.value[0],this.value[1],this.value[2],this.value[3]]);this.ikey&&this.putData(this.ikey,new Pe("vec4",Object(o["v"])(e))),this.emitter.trigger("process")}},mounted:function(){this.value=this.getData(this.ikey),this.value?this.putData(this.ikey,new Pe("vec4",Object(o["v"])(this.value))):(this.value=[0,0,0,0],this.putData(this.ikey,new Pe("vec4",[0,0,0,0])))}};n("dd26");const jn=fe()(On,[["render",kn],["__scopeId","data-v-49839787"]]);var wn=jn,Sn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r;return Object(v["a"])(this,n),r=t.call(this,o),r.component=wn,r.props={emitter:e,ikey:o,readonly:a},r}return Object(p["a"])(n,[{key:"setValue",value:function(e){this.vueContext.value=e}}]),n}(m["c"].Control),xn=Sn;function In(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])("div")}var Cn={name:"VueNumControl",props:["readonly","emitter","ikey","getData","putData","type"],data:function(){return{value:0}},methods:{change:function(e){var t=ge([this.$refs.x.value,this.$refs.y.value,this.$refs.z.value,this.$refs.w.value]),n=0;switch(this.type.value){case"float":n=t[0];break;case"vec2":n=[t[0],t[1]];break;case"vec3":n=[t[0],t[1],t[2]];break;case"vec4":n=[t[0],t[1],t[2],t[3]];break}this.value=n},update:function(){}},mounted:function(){this.value=this.getData(this.ikey),this.value||(this.value=0)}};n("a4d5");const Tn=fe()(Cn,[["render",In],["__scopeId","data-v-1d0683ba"]]);var _n=Tn,Nn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,a,r){var i;return Object(v["a"])(this,n),i=t.call(this,a),i.component=_n,i._types=Object(o["p"])(new Set),i.props={emitter:e,ikey:a,readonly:r,type:i._type},i}return Object(p["a"])(n,[{key:"setValue",value:function(e){this.vueContext.value=e.value}}]),n}(m["c"].Control),Mn=Nn;var Pn=Object(p["a"])((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Output",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];Object(v["a"])(this,e),this.methods=t,this.outputSet=Ve.gatherMethodsTypeSet(t,""),this.inputSets=Dn(t,a),this.inputKeys=a,this.outputName=n,this.inputNames=o}));function Dn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],o=new Map,a=Object(O["a"])(n);try{for(a.s();!(t=a.n()).done;){var r=t.value,i=Ve.gatherMethodsTypeSet(e,r);o.set(r,i)}}catch(c){a.e(c)}finally{a.f()}return o}var Vn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o){var a;Object(v["a"])(this,n),a=t.call(this,e),o.length||(o=[o]),a.methodsLists=o,a.inputSets=new Map;var r,i=Object(O["a"])(a.methodsLists);try{for(i.s();!(r=i.n()).done;){var c,s=r.value,u=Object(O["a"])(s.inputSets.keys());try{for(u.s();!(c=u.n()).done;){var l=c.value,h=s.inputSets.get(l),f=new Set;a.inputSets.set(l,f);var d,p=Object(O["a"])(h.values());try{for(p.s();!(d=p.n()).done;){var m=d.value;f.add(m)}}catch(b){p.e(b)}finally{p.f()}}}catch(b){u.e(b)}finally{u.f()}}}catch(b){i.e(b)}finally{i.f()}return console.log(Object(qt["a"])(a)),a.lastConnection=null,a.installed=!1,a}return Object(p["a"])(n,[{key:"getSocketType",value:function(e){return"null"}},{key:"_createOutputSocket",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"num_out",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Output",a=this.getSocketType(t);if("null"!=a.name){var r=this._addNumSocketOutput(e,n,o,a);r.possibleSocket=this._wrapSocketType(t),r.alwaysShowName=!0}}},{key:"_createInputSocket",value:function(e,t,n,o){var a=this.getSocketType(this._wrapSocketType(t));if("null"!=a.name){var r=this._addNumSocketInput(e,n,o,a,Mn);r.possibleSocket=this._wrapSocketType(t),r.alwaysShowName=!0}}},{key:"_getInputName",value:function(e){return this.methodsLists[0].inputNames[e]}},{key:"_getInputKeys",value:function(){return this.methodsLists[0].inputKeys}},{key:"builder",value:function(e){var t=this;Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e);var o,a=0,r=Object(O["a"])(this.methodsLists);try{for(r.s();!(o=r.n()).done;){var i=o.value;this._createOutputSocket(e,i.outputSet,"out_".concat(a),i.outputName),a++}}catch(l){r.e(l)}finally{r.f()}var c,s=Object(O["a"])(this.inputSets.keys());try{for(s.s();!(c=s.n()).done;){var u=c.value;this._createInputSocket(e,this.inputSets.get(u),"".concat(u),this._getInputName(u))}}catch(l){s.e(l)}finally{s.f()}return!this.installed&&this.editor&&(this.installed=!0,this.editor.on("connectionpath",(function(e){e.points;var n=e.connection;e.d;t.lastConnection=n}))),e}},{key:"removeConnections",value:function(e){var t,n=[],o=Object(O["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;n.push(a)}}catch(s){o.e(s)}finally{o.f()}for(var r=0,i=n;r<i.length;r++){var c=i[r];this.editor.removeConnection(c)}}},{key:"updateSocketConnections",value:function(e){var t,n=e.connections,o=[],a=Object(O["a"])(n);try{for(a.s();!(t=a.n()).done;){var r=t.value;o.push(r)}}catch(l){a.e(l)}finally{a.f()}for(var i=0,c=o;i<c.length;i++){var s=c[i],u=s.input.checkConnection(s)&&s.output.checkConnection(s);u||(console.log("remove connection",s),this.editor.removeConnection(s))}}},{key:"_wrapSocketType",value:function(e){var t=new Set;if(!e)return t;var n,o=Object(O["a"])(e.values());try{for(o.s();!(n=o.n()).done;){var a=n.value;t.add(this._getSocket(a))}}catch(r){o.e(r)}finally{o.f()}return t}},{key:"resetInputSocketsType",value:function(e){var t,n=Object(O["a"])(this.inputSets.keys());try{for(n.s();!(t=n.n()).done;){var o=t.value,a="".concat(o),r=e.inputs.get(a),i=this.inputSets.get(o);r.setSocket(this._getSocket("null")),r.possibleSocket=this._wrapSocketType(i)}}catch(c){n.e(c)}finally{n.f()}}},{key:"worker",value:function(e,t,o){this.clearErrorInfo(e);for(var a=this.getRealNode(e),r=this._extractInput(e,t),i=[],c=0;c<this.methodsLists.length;c++){var s=this.methodsLists[c],u="out_".concat(c),l=Ve.matchPartMethods(s.methods,null,r),h=a.outputs.get(u);if(console.log("Match result",l),h.possibleSocketTemp=this._wrapSocketType(Ve.gatherMethodsTypeSet(l.allMatch,"")),console.log(h.possibleSocketTemp),l.fullMatch.length>0){var f,d=Object(O["a"])(l.fullMatch);try{for(d.s();!(f=d.n()).done;){var v=f.value;i.push(v)}}catch(T){d.e(T)}finally{d.f()}var p=l.fullMatch[0];o[u]=p.execute(r),h.setSocket(this._getSocket(o[u].type.name)),h.possibleSocket=new Set,h.hide=!1,this.updateSocketConnections(h)}else if(l.nullMatch.length>0){var m,b=Object(O["a"])(l.nullMatch);try{for(b.s();!(m=b.n()).done;){var y=m.value;i.push(y)}}catch(T){b.e(T)}finally{b.f()}h.setSocket(this._getSocket("null")),h.possibleSocket=this._wrapSocketType(Ve.gatherMethodsTypeSet(l.nullMatch,"")),h.hide=!1,this.updateSocketConnections(h)}else h.setSocket(this._getSocket("null")),h.possibleSocket=new Set,h.hide=!0,this.updateSocketConnections(h)}if(0==i.length)throw this.editor.removeConnection(this.lastConnection),this.lastConnection=null,this.resetInputSocketsType(a),this.setErrorInfo(e,"Cannot match"),Error("Cannot match!");var g=Dn(i,this._getInputKeys());console.log(g);var k,w=Object(O["a"])(g.keys());try{for(w.s();!(k=w.n()).done;){var S=k.value,x="".concat(S),I=a.inputs.get(x),C=g.get(S);I.possibleSocketTemp=this._wrapSocketType(C),console.log(C),0!=t[S].length&&(C.size>1?(I.setSocket(this._getSocket("null")),I.possibleSocket=this._wrapSocketType(C),this.updateSocketConnections(I)):1==C.size?(I.setSocket(this._getSocket(Object(j["a"])(C.values())[0])),I.possibleSocket=this._wrapSocketType(C),this.updateSocketConnections(I)):(I.possibleSocket=new Set,this.updateSocketConnections(I)))}}catch(T){w.e(T)}finally{w.f()}a.vueContext.$forceUpdate(),this.resetInputSocketsType(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Ln=new Vn("Add",new Pn(Xt["add"],"Result",{num:"Number",num2:"+Number"},["num","num2"])),zn=new Vn("Division",new Pn(Xt["div"],"Result",{num:"Number",num2:"/Number"},["num","num2"])),Rn=new Vn("Multiply",new Pn(Xt["mult"],"Result",{num:"Number",num2:"*Number"},["num","num2"])),En=new Vn("Minus",new Pn(Xt["minus"],"Result",{num:"Number",num2:"-Number"},["num","num2"])),An=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"OutputComponent")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addInput(e,"out","Output Color"),e}},{key:"worker",value:function(e,t,o){e.result=t["out"],void 0!=e.result&&0!=e.result.length||(e.result=["0"]),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Bn=An,Wn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(e,o,a){var r;return Object(v["a"])(this,n),r=t.call(this,e),r.socketName=o,r.variable=a,r}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketOutput(e,"num",this.socketName,this.variable.type.name),e}},{key:"worker",value:function(e,t,o){o["num"]=this.variable,Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Fn=Wn,$n=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Number To Vec2")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketInput(e,"r","X","float"),this._addNumSocketInput(e,"g","Y","float"),this._addNumSocketOutput(e,"rgb","2D Position/Vector2","vec2"),e}},{key:"worker",value:function(e,t,o){var a=this._extractInput(e,t);o["rgb"]=Xt["varying"][0].execute(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Un=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Number To Vec3")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketInput(e,"r","Red","float"),this._addNumSocketInput(e,"g","Green","float"),this._addNumSocketInput(e,"b","Blue","float"),this._addNumSocketOutput(e,"rgb","RGB Color/Vector3","vec3"),e}},{key:"worker",value:function(e,t,o){var a=this._extractInput(e,t);o["rgb"]=Xt["varying"][1].execute(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Hn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Number To Vec4")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketInput(e,"r","Red","float"),this._addNumSocketInput(e,"g","Green","float"),this._addNumSocketInput(e,"b","Blue","float"),this._addNumSocketInput(e,"a","Alpha","float"),this._addNumSocketOutput(e,"rgb","RGBA Color/Vector4","vec4"),e}},{key:"worker",value:function(e,t,o){var a=this._extractInput(e,t);o["rgb"]=Xt["varying"][2].execute(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Kn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Vec2 to Numbers")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketInput(e,"v","Vector 2D","vec2",rn),this._addNumSocketOutput(e,"r","X","float"),this._addNumSocketOutput(e,"g","Y","float"),e}},{key:"worker",value:function(e,t,o){var a=this._extractInput(e,t);o["r"]=Ve.matchMethod(Xt["extract"],"extract_r",a).execute(a),o["g"]=Ve.matchMethod(Xt["extract"],"extract_g",a).execute(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Yn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Vec3 to Numbers")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketInput(e,"v","Vector3/RGB Color","vec3",pn),this._addNumSocketOutput(e,"r","X / Red","float"),this._addNumSocketOutput(e,"g","Y / Green","float"),this._addNumSocketOutput(e,"b","Z / Blue","float"),e}},{key:"worker",value:function(e,t,o){var a=this._extractInput(e,t);o["r"]=Ve.matchMethod(Xt["extract"],"extract_r",a).execute(a),o["g"]=Ve.matchMethod(Xt["extract"],"extract_g",a).execute(a),o["b"]=Ve.matchMethod(Xt["extract"],"extract_b",a).execute(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Gn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"Vec4 to Numbers")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketInput(e,"v","Vector4/RGBA Color","vec4",xn),this._addNumSocketOutput(e,"r","X / Red","float"),this._addNumSocketOutput(e,"g","Y / Green","float"),this._addNumSocketOutput(e,"b","Z / Blue","float"),this._addNumSocketOutput(e,"a","W / Alpha","float"),e}},{key:"worker",value:function(e,t,o){var a=this._extractInput(e,t);o["r"]=Ve.matchMethod(Xt["extract"],"extract_r",a).execute(a),o["g"]=Ve.matchMethod(Xt["extract"],"extract_g",a).execute(a),o["b"]=Ve.matchMethod(Xt["extract"],"extract_b",a).execute(a),o["a"]=Ve.matchMethod(Xt["extract"],"extract_a",a).execute(a),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Zn=new Vn("Dot Product",new Pn(Xt["dot"],"Number",{a:"Vector",b:"Vector"},["a","b"])),Xn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"2D Vector")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketOutput(e,"num","2D Vector","vec2"),e.addControl(new rn(this.editor,"num")),e}},{key:"worker",value:function(e,t,o){o["num"]=e.data.num,console.log(o),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),qn=Xn,Jn=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"3D Vector")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketOutput(e,"num","3D Vector","vec3"),e.addControl(new pn(this.editor,"num")),e}},{key:"worker",value:function(e,t,o){o["num"]=e.data.num,console.log(o),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),Qn=Jn,eo=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){return Object(v["a"])(this,n),t.call(this,"4D Vector")}return Object(p["a"])(n,[{key:"builder",value:function(e){return Object(Ke["a"])(Object(Ye["a"])(n.prototype),"builder",this).call(this,e),this._addNumSocketOutput(e,"num","4D Vector","vec4"),e.addControl(new xn(this.editor,"num")),e}},{key:"worker",value:function(e,t,o){o["num"]=e.data.num,console.log(o),Object(Ke["a"])(Object(Ye["a"])(n.prototype),"worker",this).call(this,e,t,o)}}]),n}(It),to=eo,no=(n("fb6a"),function(){function e(){Object(v["a"])(this,e),this.inputKey=null,this.inputID=null,this.outputKey=null,this.outputID=null,this.data={}}return Object(p["a"])(e,[{key:"genKey",value:function(){return"".concat(this.inputKey,"_").concat(this.inputID,"|").concat(this.outputKey,"_").concat(this.outputID)}},{key:"fromConnection",value:function(e){return this.data=xe(e.data),this.inputKey=e.input.key,this.inputID=e.input.node.id,this.outputKey=e.output.key,this.outputID=e.output.node.id,this}}]),e}()),oo=function(){function e(){Object(v["a"])(this,e),this.id=null,this.ref=null,this.data={},this.position=[0,0],this.connections=[],this.name=""}return Object(p["a"])(e,[{key:"genKey",value:function(){return this.id}},{key:"fromNode",value:function(e){return this.ref=e,this.data=xe(e.data),this.id=e.id,this.position=Object(j["a"])(e.position),this.name=e.name,this}}]),e}(),ao=function(){function e(){Object(v["a"])(this,e),this.nodes=new Map,this.connections=new Map,this.fromSocket=null,this.fromNode=null,this.outputSocket=null,this.outputSocketTemplate=null,this.relativePosition=[0,0],this.retainConnection=!1}return Object(p["a"])(e,[{key:"saveSocket",value:function(e){if(this.fromNode=e.node,this.fromSocket=e,this.relativePosition=Object(j["a"])(e.node.position),e instanceof m["c"].Output)this.outputSocket=e,this._saveNode(e.node),this.outputSocketTemplate={id:e.node.id,key:e.key};else{if(!e.connections.length)return console.log(e),console.log(e.node.inputs.get(e.key)),console.log(e.key),this._saveNode(e.node,!1),this.outputSocket=e,void(this.retainConnection=!0);this.outputSocket=e.connections[0].output,this._saveNode(e.connections[0].output.node),this.outputSocketTemplate={id:this.outputSocket.node.id,key:this.outputSocket.key}}}},{key:"_saveNode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n,o=Object(O["a"])(e.inputs.keys());try{for(o.s();!(n=o.n()).done;){var a,r=n.value,i=e.inputs.get(r),c=Object(O["a"])(i.connections);try{for(c.s();!(a=c.n()).done;){var s=a.value;this._saveConnection(s),this._saveNode(s.output.node)}}catch(l){c.e(l)}finally{c.f()}}}catch(l){o.e(l)}finally{o.f()}}var u=(new oo).fromNode(e);this.nodes.set(u.genKey(),u)}},{key:"_saveConnection",value:function(e){var t=(new no).fromConnection(e);this.connections.set(t.genKey(),t)}},{key:"applyToEditor",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,o,a,r,i,c,s,u,l,h,f,d,v,p,m,b,y,g,k,w,S,x,I,C,T,_,N,M,P,D,V,L,z,R,E,A,B,W,F,$,U,H,K,Y,G,Z,X,q=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=q.length>1&&void 0!==q[1]&&q[1],o=q.length>2&&void 0!==q[2]?q[2]:[0,0],a=t.view.nodes,r=new Map,i=new Map,c=Object(O["a"])(this.nodes.values()),e.prev=6,c.s();case 8:if((s=c.n()).done){e.next=30;break}if(u=s.value,n||!a.has(u.ref)){e.next=15;break}for(l in u.data)u.ref.setData(l,u.data[l]);r.set(u.id,u.ref),e.next=28;break;case 15:return h=t.components.get(u.name),f=xe(u.data),e.next=19,h.createNode(f);case 19:for(v in d=e.sent,console.log("new node!!",d),d.position=Object(j["a"])(u.position),console.log("alwaysCreateNew",n),n&&(d.position[0]+=o[0]-this.relativePosition[0],d.position[1]+=o[1]-this.relativePosition[1]),t.addNode(d),u.data)d.setData(v,u.data[v]);r.set(u.id,d),i.set(u.id,d);case 28:e.next=8;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e["catch"](6),c.e(e.t0);case 35:return e.prev=35,c.f(),e.finish(35);case 38:console.log(this.connections),p=[],m=Object(O["a"])(this.connections.values());try{for(m.s();!(b=m.n()).done;)y=b.value,g=r.get(y.inputID),k=r.get(y.outputID),w=!1,S=y.genKey(),i.has(y.inputID)&&(y.inputID=g.id,w=!0),i.has(y.outputID)&&(y.outputID=k.id,w=!0),w&&p.push([y,S])}catch(J){m.e(J)}finally{m.f()}x=Object(O["a"])(i.keys());try{for(x.s();!(I=x.n()).done;)C=I.value,T=i.get(C),_=T.id,N=this.nodes.get(C),N.id=_,N.ref=T,this.nodes.set(_,N),this.nodes.delete(C),console.log("update node id",C,_,T,N)}catch(J){x.e(J)}finally{x.f()}for(M=0,P=p;M<P.length;M++)D=P[M],V=D[0],L=D[1],this.connections.delete(L),this.connections.set(V.genKey(),V),console.log("update connection",L,V.genKey(),V);if(!this.retainConnection){z=Object(O["a"])(this.nodes.values());try{for(z.s();!(R=z.n()).done;){E=R.value,console.log(E.ref.inputs),A=Object(O["a"])(E.ref.inputs.values());try{for(A.s();!(B=A.n()).done;)W=B.value,F=W.connections[0],F&&($=(new no).fromConnection(F).genKey(),this.connections.has($)||(console.log("remove connection ",F),t.removeConnection(F)))}catch(J){A.e(J)}finally{A.f()}}}catch(J){z.e(J)}finally{z.f()}}U=Object(O["a"])(this.connections.values());try{for(U.s();!(H=U.n()).done;)K=H.value,Y=this.nodes.get(K.inputID).ref,G=this.nodes.get(K.outputID).ref,Z=Y.inputs.get(K.inputKey),X=G.outputs.get(K.outputKey),t.connect(X,Z,xe(K.data))}catch(J){U.e(J)}finally{U.f()}return console.log(this),e.abrupt("return",i);case 50:case"end":return e.stop()}}),e,this,[[6,32,35,38]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),ro=ao;function io(e){return"socket_".concat(e.key,"_").concat(e.node.id,"_").concat(e instanceof m["c"].Output?"out":"in")}function co(e){return"single_"+Math.random().toString(36).slice(-6)+"_"+e}var so=function(){function e(t,n){var o=this;Object(v["a"])(this,e),this.editor=t,this.manager=n,this._comp=new Ct,this.editor.register(this._comp),this.previews=new Map,this.pointFloat=new Map,this.independentPreviewInteraction=new uo(this),this._enablePreview=!1,this.editor.on("nodecreated",(function(e){console.log(e),e instanceof Tt||o.setupInteraction(e)})),this.editor.on("noderemoved",(function(e){o.pointFloat.delete(e.id)}))}return Object(p["a"])(e,[{key:"addPreview",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var o,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.previews.has(n)){e.next=5;break}return console.log("Already existing preview",n),o=this.previews.get(n),o.setPosition(this.editor,t),e.abrupt("return",o);case 5:return a=this.manager.context.modelStore.roughClone(),console.log("add Preview",n),e.next=9,this._comp.createNode({modelStore:a});case 9:return r=e.sent,r.position=t,this.editor.addNode(r),this.previews.set(n,r),e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"renamePreview",value:function(e,t){this.previews.has(e)?(this.previews.has(t)&&console.warn("Duplicated preview id"),this.previews.set(t,this.previews.get(e)),this.previews.delete(e)):console.log("Unknown preview",e)}},{key:"removePreview",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.previews.has(e)){var n=this.previews.get(e);"lock"!=n.state||t?(console.log("remove Preview",e),this.editor.removeNode(n),this.previews.delete(e)):console.log("preview locked",e)}else console.log("remove Preview (failed)",e)}},{key:"getNodeView",value:function(e){return this.editor.view.nodes.get(e)}},{key:"getSocketView",value:function(e){return this.editor.view.nodes.get(e.node).sockets.get(e)}},{key:"addPreviewAlongConnection",value:function(e){var t,n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,a="c_".concat(e.input.id,"_").concat(e.output.id,"_").concat(o),r=function(a){var r=e.input.position,i=e.output.position;t.setPosition(n.editor,Se(r,i,o))},i=function(e){n.removePreview(a)};return 0!=o&&(e.input.on("translatenode",r),e.input.on("noderemoved",i)),1!=o&&(e.output.on("translatenode",(function(e){return r(e)})),e.output.on("noderemoved",i)),t=this.addPreview(r(null),a),t}},{key:"addPreviewAlongSocket",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,o,a,r,i,c,s,u,l,h,f,d,v=this,p=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:function(e){return[0,5]},o=io(t),e.next=4,this.addPreview([100,0],o);case 4:return a=e.sent,r=[0,0],i=null,c=160,s=function(e){var o=v.getSocketView(t),i=o.getPosition(o.node),c=a.el;c||(c={clientWidth:100,clientHeight:100}),t instanceof m["c"].Output?i[0]+=n(t)[0]:i[0]-=n(t)[0]+c.clientWidth,i[1]+=n(t)[1]-c.clientHeight/2,a.setPosition(v.editor,i),r=Object(j["a"])(i)},u=function(e){v.removePreview(o)},l=function(e){var n=e.node;if(t instanceof m["c"].Output)a.variable=e.outputData[t.key];else{var o=v.editor.components.get(n.name).extractInputKey(n,e.inputData,t.key);a.variable=o}},h=function(e){Ce(a.position,r)>c?a.addNodeClass("preview-independ-try"):a.removeNodeClass("preview-independ-try")},f=function(e){i&&clearInterval(i),i=null},d=function e(n){if(console.log("drag end",n),Ce(a.position,r)>c){a.removeNodeClass("preview-independ-try");var d=co(o);v.renamePreview(o,d),t.node.removeListener("translatenode",s),t.node.removeListener("noderemoved",u),t.node.removeListener("nodeworked",l),a.removeListener("nodedraged",e),a.removeListener("translatenode",h),a.removeListener("selectnode",f),a.templateData=new ro,a.templateData.saveSocket(t),console.log(a.templateData),a.addNodeClass("preview-independ"),v.independentPreviewInteraction.installPreview(a)}else i=setInterval((function(){var e=[a.position[0]-r[0],a.position[1]-r[1]],t=[a.position[0]-.07*e[0],a.position[1]-.07*e[1]];a.setPosition(v.editor,t),h()}),30)},t.node.on("translatenode",s),t.node.on("noderemoved",u),t.node.on("nodeworked",l),a.on("translatenode",h),a.on("nodedraged",d),a.on("selectnode",f),s(),r=Object(j["a"])(a.position),e.abrupt("return",a);case 23:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removePreviewAlongSocket",value:function(e){var t=io(e);this.removePreview(t)}},{key:"removePreviewsSurroundNode",value:function(e){console.log("remove previews",e);var t=this.getNodeView(e);if(t){var n,o=t.sockets,a=Object(O["a"])(o.keys());try{for(a.s();!(n=a.n()).done;){var r=n.value;this.removePreviewAlongSocket(r)}}catch(i){a.e(i)}finally{a.f()}}}},{key:"addPreviewsSurroundNode",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,o,a,r,i,c,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=this.getNodeView(t),o=n.sockets,a=[],r=new fo(this,t),i=Object(O["a"])(o.keys()),e.prev=5,i.s();case 7:if((c=i.n()).done){e.next=15;break}return s=c.value,e.next=11,this.addPreviewAlongSocket(s,(function(e){return r.offsets.get(e)}));case 11:u=e.sent,a.push(u);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](5),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:return r.relayoutAll(),e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this,[[5,17,20,23]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setupInteraction",value:function(e){var t=this.getNodeView(e),n=t.el,o=new vo(this,e,n,this._enablePreviewTime);this.pointFloat.set(e.id,o)}},{key:"enablePreview",set:function(e){if(this._enablePreview!=e){this._enablePreview=e;var t=this._enablePreviewTime;console.log(this.pointFloat);var n,o=Object(O["a"])(this.pointFloat.values());try{for(o.s();!(n=o.n()).done;){var a=n.value;a.timeoutIn=t}}catch(r){o.e(r)}finally{o.f()}}}},{key:"_enablePreviewTime",get:function(){return this._enablePreview?200:-1}}]),e}(),uo=function(){function e(t){Object(v["a"])(this,e),this.manager=t,this.editor=this.manager.editor,this.tempTemplate=null}return Object(p["a"])(e,[{key:"installPreview",value:function(e){var t=this;e.operations=[],e.state="apply";var n=function(){var n=e.templateData,o=t.manager.getNodeView(n.fromSocket.node),a=!1;return o=t.manager.getNodeView(n.outputSocket.node),console.log(o),o?(o=o.sockets.get(n.outputSocket),console.log(o)):o=null,o?t.tempTemplate.saveSocket(n.outputSocket):(t.tempTemplate=null,a=!0),a};e.applyFunc2=Object(r["a"])(regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=Object(j["a"])(e.position),a[0]-=e.el.clientWidth,a[1]-=e.el.clientHeight,o.next=5,e.templateData.applyToEditor(t.editor,n(),a);case 5:case"end":return o.stop()}}),o)}))),e.applyFunc=Object(r["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=Object(j["a"])(e.position),o[0]-=e.el.clientWidth,o[1]-=e.el.clientHeight,n.next=5,e.templateData.applyToEditor(t.editor,!0,o);case 5:case"end":return n.stop()}}),n)})));var o=function(){var o=Object(r["a"])(regeneratorRuntime.mark((function o(a){var r,i,c,s,u,l,h,f,d,v,p;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:console.log("pointerEnter",a),r=t.editor.view.nodes,t.tempTemplate=new ro,i=e.templateData,t.manager.getNodeView(i.fromSocket.node),c=n(),s=Object(O["a"])(e.templateData.nodes.values());try{for(l=function(){var t=u.value,n=t.ref;if(r.has(n))for(var o in n.addNodeClass("node-highlight"),e.operations.push((function(){n.removeNodeClass("node-highlight")})),t.data){var a=t.data[o];if("undefined"!=typeof a){var i=n.data[o];if("undefined"!=typeof i){var c=a==i;!c&&a instanceof Pe&&i instanceof Pe&&(c=a.isEquals(i)),c||function(){var t=n.getControl(o);t&&(console.log(t),n.addControlStyle(t,"border: solid 1px red;"),e.operations.push((function(){n.removeControlStyle(t,"border: solid 1px red;")})))}()}}}},s.s();!(u=s.n()).done;)l()}catch(m){s.e(m)}finally{s.f()}return h=Object(j["a"])(e.position),h[0]-=e.el.clientWidth,h[1]-=e.el.clientHeight,o.next=13,e.templateData.applyToEditor(t.editor,c,h);case 13:f=o.sent,d=Object(O["a"])(f.values());try{for(d.s();!(v=d.n()).done;)p=v.value,p.addNodeClass("node-highlight-fake")}catch(m){d.e(m)}finally{d.f()}e.operations.push((function(){console.log("remove nodes",f);var e,n=Object(O["a"])(f.values());try{for(n.s();!(e=n.n()).done;){var o=e.value;o.removeNodeClass("node-highlight-fake"),t.editor.removeNode(o)}}catch(m){n.e(m)}finally{n.f()}}));case 17:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),a=function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(o){var a,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:console.log("pointerLeave",o),a=Object(O["a"])(e.operations);try{for(a.s();!(r=a.n()).done;)i=r.value,i()}catch(c){a.e(c)}finally{a.f()}if(e.operations=[],!t.tempTemplate){n.next=7;break}return n.next=7,t.tempTemplate.applyToEditor(t.editor);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();e.el.addEventListener("pointerenter",o),e.el.addEventListener("pointerleave",a)}}]),e}();function lo(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]}function ho(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}var fo=function(){function e(t,n){Object(v["a"])(this,e),this.node=n,this.manager=t;var o=t.getNodeView(n),a=o.sockets,r=[],i=[],c=null,s=null,u=null,l=null,h=[0,0],f=[0,0];this.offsets=new Map;var d,p=Object(O["a"])(a.keys());try{for(p.s();!(d=p.n()).done;){var b=d.value,y=this.manager.getSocketView(b).getPosition(b.node);b instanceof m["c"].Output?(i.push(b),f[0]+=y[0],f[1]+=y[1],l=l?ho(l,y):y,u=u?lo(u,y):y):(r.push(b),h[0]+=y[0],h[1]+=y[1],s=c?ho(s,y):y,c=c?lo(c,y):y)}}catch(g){p.e(g)}finally{p.f()}r.length>0&&(h[0]=s[0]-c[0],h[1]=s[1]-c[1]),i.length>0&&(f[0]=l[0]-u[0],f[1]=l[1]-u[1]),this.inSocketAvgPos=h,this.outSocketAvgPos=f,this.ins=r,this.outs=i,this.relayoutAll()}return Object(p["a"])(e,[{key:"relayoutAll",value:function(){this.relayout(this.ins,this.inSocketAvgPos),this.relayout(this.outs,this.outSocketAvgPos)}},{key:"relayout",value:function(e,t){for(var n=[],o=0,a=0,r=null,i=0;i<e.length;i++){var c=e[i],s=io(c),u=this.manager.previews.get(s),l=this.manager.getNodeView(u),h=Tt.defaultHeight;l&&(l=l.el,h=l.clientHeight);var f=this.manager.getSocketView(c),d=f.getPosition(c.node),v=10;if(f.el&&(v=f.el.clientHeight),0==i)n.push([o+h/2,0]),r=d[1],a=v;else{var p=d[1]-r;a+=p,n.push([o+h/2,p]),r=d[1]}o+=h+2}for(var m=this.manager.getNodeView(this.node),b=m.el.clientHeight,y=o+a,g=-Math.max(.2,Math.pow(Math.min(1,b/y),2)),k=o+a*g,O=-k/2,j=-t[1]/2,w=0;w<e.length;w++){var S=e[w];io(S);j+=n[w][1];var x=n[w][0]+O-j+(a/2-j)*g;this.offsets.set(S,[20,x])}}}]),e}(),vo=Object(p["a"])((function e(t,n,o){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:800;Object(v["a"])(this,e),this.manager=t,this.el=o,this.pres=[];var s=0,u=1,l=2,h=3;this.state=s,this.partState=!1,this.timerIn=null,this.timerOut=null,this.timeoutIn=i,this.timeoutOut=c;var f=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,o,r,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.state=l,e.next=3,a.manager.addPreviewsSurroundNode(n);case 3:a.pres=e.sent,t=Object(O["a"])(a.pres);try{for(t.s();!(o=t.n()).done;)r=o.value,i=a.manager.getNodeView(r),c=i.el,c.addEventListener("pointerenter",p),c.addEventListener("pointerleave",m)}catch(s){t.e(s)}finally{t.f()}a.partState=!1;case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){a.state=s,a.manager.removePreviewsSurroundNode(n);var e,t=[],o=Object(O["a"])(a.pres);try{for(o.s();!(e=o.n()).done;){var r=e.value;"lock"==r.state&&t.push(r)}}catch(i){o.e(i)}finally{o.f()}a.pres=t,a.pres.length?a.partState=!0:a.partState=!1},p=function(e){switch(a.state){case h:a.state=l,clearTimeout(a.timerOut);break}},m=function(e){switch(a.state){case l:a.state=h,a.partState&&clearTimeout(a.timerIn),a.timerOut=setTimeout(d,a.timeoutOut);break;case s:a.partState&&(a.timerOut=setTimeout(d,a.timeoutOut))}},b=function(e){switch(a.state){case s:a.state=u,a.timerIn=a.timeoutIn<0?null:setTimeout(f,a.timeoutIn),clearTimeout(a.timerOut);break;case h:a.state=l,clearTimeout(a.timerOut);break}},y=function(e){switch(a.state){case l:a.state=h,a.timerOut=setTimeout(d,a.timeoutOut);break;case u:a.state=s,clearTimeout(a.timerIn);break}};o.addEventListener("pointerenter",b),o.addEventListener("pointerleave",y)})),po=so,mo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(v["a"])(this,e),this.container=t,this.context={mesh:null,name:"shader",matBuilder:new Ae,modelStore:n},this.components=[],this.previewManager=null}return Object(p["a"])(e,[{key:"_initEditor",value:function(e){var t=new m["c"].NodeEditor("".concat(e,"@0.1.0"),this.container);this.editor=t,t.use(b["a"]),t.use(y["a"]),t.use(g["a"]),t.use(k["a"]),t.use(Nt),t.use(T);var n=new m["c"].Engine("".concat(e,"@0.1.0"));this.engine=n,this.components.map((function(e){t.register(e),n.register(e)})),t.on("process nodecreated noderemoved connectioncreated connectionremoved",Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("process"),e.next=3,n.abort();case 3:return e.next=5,n.process(t.toJSON());case 5:case"end":return e.stop()}}),e)})))),this._initNode(),t.view.resize(),k["a"].zoomAt(t),t.trigger("process"),this.previewManager=new po(this.editor,this),console.log(this.editor)}},{key:"removeAll",value:function(){delete this.editor,delete this.engine;for(var e=0;e<this.components.length;e++)delete this.components[e];delete this.components,this.components=[],Oe(this.container)}},{key:"_addMethod",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Result",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.length||(e=[e]);var a=[];for(var r in o)a.push(r);var i=new Pn(e,n,o,a),c=new Vn(t,i);this.components.push(c)}},{key:"_buildComponents",value:function(){var e=this;this.outputComponent=new Bn,this.components=[new Pt,Ln,En,zn,Rn,Zn,new qn,new Qn,new to,new $n,new Un,new Hn,new Kn,new Yn,new Gn,this.outputComponent];var t=this.context.mesh;if(t){var n=t.geometry.attributes;for(var o in n){var a=n[o],r=ke(a);if(r){var i=new Fn("".concat(o," (").concat(r,")"),r,new Pe(r,"".concat(o).concat(ze)));console.log("Add component: ".concat(o," (").concat(r,")")),this.components.push(i)}}}var c=new Fn("Texture (Texture2D)","texture2D",new Pe("texture2D","ourTexture"));this._addMethod(new Ve("sampleTexture2D",{t:"texture2D",uv:"vec2"},"vec4",(function(){}),"texture2D(#t#,#uv#)"),"Sample Texture","Color (Vec4)",{t:"Texture",uv:"Sample Position (UV)"}),this._addMethod(new Ve("CrossProduct",{a:"vec3",b:"vec3"},"vec3",(function(e,t){return[e[1]*t[2]-t[1]*e[2],e[2]*t[0]-t[2]*e[0],e[0]*t[1]-t[0]*e[1]]}),"cross(#t#,#uv#)"),"Cross Product","Vector 3",{a:"Value a",b:"Value b"}),this._addMethod(Xt["step"],"Threshold","Is Pass?",{v1:"Threshold",v2:"Test value"}),this._addMethod(Xt["mix"],"Mix","Result",{v1:"Value 1",v2:"Value 2",v3:"weight"}),this._addMethod(Xt["max"],"Max","Result",{v1:"Value 1",v2:"Value 2"}),this._addMethod(Xt["min"],"Min","Result",{v1:"Value 1",v2:"Value 2"}),this._addMethod(Xt["pow"],"Power","A^B",{v1:"Value A",v2:"Value B"}),this._addMethod(Xt["sin"],"Sin","result",{v1:"Value A",v2:"Value B"}),this._addMethod(Xt["cos"],"Cos","result",{v1:"Value A",v2:"Value B"}),this._addMethod(Xt["tan"],"Tan","result",{v1:"Value A",v2:"Value B"}),this.components.push(c),this.outputComponent.addWorkEvent((function(t){console.log("--- Final result ---");var n=t.result[0];console.log(n),e.context.matBuilder.fragShader=n,console.log("------- END -------"),e.context.modelStore.applyMaterialToAll(e.context.matBuilder.newMaterial)}))}},{key:"rebuild",value:function(){this.removeAll(),this._buildComponents(),this._initEditor(this.context.name)}},{key:"modelStore",set:function(e){console.log("Set modelStore in rete"),this.context.modelStore=e,this.mesh=e.sampleMesh}},{key:"mesh",set:function(e){this.context.mesh=e,this.context.matBuilder.mesh=e,e&&(this.context.name=e.uuid),this.rebuild()}},{key:"_initNode",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,o,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("hi"),console.log(this.components),t=this.components,n=this.editor,e.next=6,t[0].createNode({num:2});case 6:return o=e.sent,e.next=9,t[0].createNode({num:0});case 9:return a=e.sent,e.next=12,t[1].createNode();case 12:return r=e.sent,e.next=15,this.outputComponent.createNode();case 15:i=e.sent,o.position=[0,200],a.position=[0,400],r.position=[300,240],i.position=[600,0],n.addNode(o),n.addNode(a),n.addNode(r),n.addNode(i),n.connect(o.outputs.get("num"),r.inputs.get("num")),n.connect(a.outputs.get("num"),r.inputs.get("num2"));case 26:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),bo=mo,yo={data:function(){return{enablePreview:!1,previousPressedCtrl:!1}},methods:{initRete:function(){var e=this.$refs.rete,t=new bo(e,this.modelStore);this.$options.rawData.rete=t},inited:function(){return this.$options.rawData.rete}},props:["modelStore"],mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:!e.inited()&&e.modelStore&&e.initRete(),document.addEventListener("keydown",(function(t){t.ctrlKey&&(e.enablePreview=!0,e.previousPressedCtrl=!0)})),document.addEventListener("keypress",(function(t){101==t.charCode&&(e.enablePreview=!e.enablePreview)})),document.addEventListener("keyup",(function(t){!t.ctrlKey&&e.previousPressedCtrl&&(e.enablePreview=!1,e.previousPressedCtrl=!1)}));case 4:case"end":return t.stop()}}),t)})))()},rawData:{rete:null},watch:{modelStore:function(e,t){console.log("Update Mesh in Scene3D"),!this.inited()&&this.modelStore&&this.initRete(),this.inited()&&(this.$options.rawData.rete.modelStore=Object(o["v"])(e))},enablePreview:{handler:function(e,t){console.log("Enable preview!!!!!!!!!!!!",e,this.$options.rawData.rete),this.$options.rawData.rete&&(this.$options.rawData.rete.previewManager.enablePreview=e)},immediate:!1}}};n("dc0f"),n("e414");const go=fe()(yo,[["render",d],["__scopeId","data-v-2ed7a4be"]]);var ko=go,Oo={id:"threejscanvas",ref:"threejscanvas"};function jo(e,t,n,a,r,i){return Object(o["m"])(),Object(o["f"])("canvas",Oo,null,512)}var wo={name:"RenderVue",mounted:function(){var e=this;this.$nextTick((function(){console.log(e.$refs),ne(e.$refs.threejscanvas)}))}};n("c475");const So=fe()(wo,[["render",jo]]);var xo=So,Io={name:"App",data:function(){return{modelStore:new He}},components:{Rete:ko,Scene3D:ve,RenderVue:xo},mounted:function(){this.loadModel(n("03d9"))},methods:{loadModel:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=new He,o.load(e,(function(){console.log("Load complete"),t.modelStore=o,console.log(t.modelStore)}));case 2:case"end":return n.stop()}}),n)})))()}},computed:{fshaders:function(){return console.log("shader changed :vue!"),this.fshaders2}}};n("39c6");const Co=fe()(Io,[["render",a]]);var To=Co;Object(o["c"])(To).mount("#app")},"60c7":function(e,t,n){},6935:function(e,t,n){},"6b2b":function(e,t,n){},"81de":function(e,t,n){"use strict";n("60c7")},8499:function(e,t){e.exports="data:image/png;base64,bW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyArICJiMzM2NjQ5ZGYxNWJhYjY0MTBmZjdhZWM0YmNkZmRkNC5wbmciOw=="},"8daf":function(e,t,n){},"9c5f":function(e,t,n){},a2fa:function(e,t,n){"use strict";n("ae66")},a4d5:function(e,t,n){"use strict";n("e40a")},ae66:function(e,t,n){},c475:function(e,t,n){"use strict";n("1735")},d8c0:function(e,t,n){},dc0f:function(e,t,n){"use strict";n("d8c0")},dd26:function(e,t,n){"use strict";n("4b27")},e27a:function(e,t,n){},e40a:function(e,t,n){},e414:function(e,t,n){"use strict";n("e27a")},e6d9:function(e,t,n){"use strict";n("6935")}});
//# sourceMappingURL=app.8871183e.js.map